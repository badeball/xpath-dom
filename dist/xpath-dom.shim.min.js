!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.xpathDom=e()}}(function(){return function e(t,r,n){function s(o,i){if(!r[o]){if(!t[o]){var p="function"==typeof require&&require;if(!i&&p)return p(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};t[o][0].call(c.exports,function(e){var r=t[o][1][e];return s(r?r:e)},c,c.exports,e,t,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(e){if(!window.document.evaluate){var t=e("./register");window.document.evaluate=t.evaluate,window.document.createExpression=t.createExpression,window.document.createNSResolver=t.createNSResolver,window.XPathResult=t.XPathResult;var r;for(r in t.XPathResultType)t.XPathResultType.hasOwnProperty(r)&&(window.XPathResult[r]=t.XPathResultType[r])}},{"./register":108}],2:[function(e,t){"use strict";function r(e){if(!e)throw new Error("This should not happen!");this.nativeNode=e}var n={DISCONNECTED:1,PRECEDING:2,FOLLOWING:4,CONTAINS:8,CONTAINED_BY:16,IMPLEMENTATION_SPECIFIC:32};r.prototype.getNativeNode=function(){return this.nativeNode},r.prototype.asString=function(){if("string"==typeof this.nativeNode.textContent)return this.nativeNode.textContent;for(var e="",t=this.getChildNodes(),r=0;r<t.length;r++)e+=t[r].asString();return e},r.prototype.asNumber=function(){return+this.asString()},r.prototype.getNodeType=function(){return this.nativeNode.nodeType},r.prototype.getChildNodes=function(){for(var e=[],t=0;t<this.nativeNode.childNodes.length;t++)e.push(new r(this.nativeNode.childNodes[t]));return e},r.prototype.getFollowingSiblings=function(){for(var e=this.nativeNode,t=[];e=e.nextSibling;)t.push(new r(e));return t},r.prototype.getPrecedingSiblings=function(){for(var e=this.nativeNode,t=[];e=e.previousSibling;)t.unshift(new r(e));return t},r.prototype.getName=function(){var e=this.nativeNode.tagName||this.nativeNode.name;return e?e.toLowerCase():void 0},r.prototype.getAttributes=function(){if(!this.nativeNode.attributes)return[];for(var e=[],t=0;t<this.nativeNode.attributes.length;t++)e.push(new r(this.nativeNode.attributes[t]));return e},r.prototype.getParent=function(){return new r(this.nativeNode.parentNode||this.nativeNode.ownerElement)},r.prototype.getOwnerDocument=function(){return this.nativeNode.ownerDocument?new r(this.nativeNode.ownerDocument):void 0},r.prototype.getElementById=function(e){var t=this.nativeNode.getElementById(e);return t?new r(t):void 0},r.prototype.isEqual=function(e){return this.getNativeNode()===e.getNativeNode()},r.compareDocumentPosition=function(e,t){e.getNativeNode()instanceof Attr&&(e=e.getParent()),t.getNativeNode()instanceof Attr&&(t=t.getParent());var r=e.getNativeNode().compareDocumentPosition(t.getNativeNode());return r&n.PRECEDING?1:r&n.FOLLOWING?-1:0},r.prototype.toString=function(){var e;return e=this.nativeNode.tagName?this.nativeNode.tagName.toLowerCase():this.nativeNode.nodeName+"("+this.nativeNode.nodeValue+")",this.nativeNode.className&&(e=e+"."+this.nativeNode.className.split(/\s+/g).join(".")),this.nativeNode.id&&(e=e+"#"+this.nativeNode.id),"Node<"+e+">"},t.exports=r},{}],3:[function(e,t){t.exports={ANCESTOR:"ancestor",ANCESTOR_OR_SELF:"ancestor-or-self",ATTRIBUTE:"attribute",CHILD:"child",DESCENDANT:"descendant",DESCENDANT_OR_SELF:"descendant-or-self",FOLLOWING:"following",FOLLOWING_SIBLING:"following-sibling",NAMESPACE:"namespace",PARENT:"parent",PRECEDING:"preceding",PRECEDING_SIBLING:"preceding-sibling",SELF:"self"}},{}],4:[function(e,t){t.exports={ABSOLUTE_LOCATION_PATH:"absolute-location-path",ADDITIVE:"additive",AND:"and",DIVISIONAL:"divisional",EQUALITY:"equality",FILTER:"filter",FUNCTION_CALL:"function-call",GREATER_THAN:"greater-than",GREATER_THAN_OR_EQUAL:"greater-than-or-equal",INEQUALITY:"inequality",LESS_THAN:"less-than",LESS_THAN_OR_EQUAL:"less-than-or-equal",LITERAL:"literal",MODULUS:"modulus",MULTIPLICATIVE:"multiplicative",NEGATION:"negation",NUMBER:"number",OR:"or",PATH:"path",RELATIVE_LOCATION_PATH:"relative-location-path",SUBTRACTIVE:"subtractive",UNION:"union"}},{}],5:[function(e,t){t.exports={COMMENT:"comment",NODE:"node",PROCESSING_INSTRUCTION:"processing-instruction",TEXT:"text"}},{}],6:[function(e,t){"use strict";var r=e("../axis_specifier"),n=e("../expr_type"),s=e("../node_type"),a=e("./step");t.exports={parse:function(e,t){for(var o={type:n.ABSOLUTE_LOCATION_PATH};!t.empty()&&"/"===t.peak()[0];)o.steps||(o.steps=[]),"/"===t.next()?a.isValidOp(t)&&o.steps.push(a.parse(e,t)):(o.steps.push({axis:r.DESCENDANT_OR_SELF,test:{type:s.NODE}}),o.steps.push(a.parse(e,t)));return o}}},{"../axis_specifier":3,"../expr_type":4,"../node_type":5,"./step":22}],7:[function(e,t){"use strict";var r=e("../expr_type"),n=e("./multiplicative_expr");t.exports={parse:function(e,s){var a=n.parse(e,s),o={"+":r.ADDITIVE,"-":r.SUBTRACTIVE};if(o.hasOwnProperty(s.peak())){var i=s.next(),p=t.exports.parse(e,s);return{type:o[i],lhs:a,rhs:p}}return a}}},{"../expr_type":4,"./multiplicative_expr":14}],8:[function(e,t){"use strict";var r=e("../expr_type"),n=e("./equality_expr");t.exports={parse:function(e,s){var a=n.parse(e,s);if("and"===s.peak()){s.next();var o=t.exports.parse(e,s);return{type:r.AND,lhs:a,rhs:o}}return a}}},{"../expr_type":4,"./equality_expr":9}],9:[function(e,t){"use strict";var r=e("../expr_type"),n=e("./relational_expr");t.exports={parse:function(e,s){var a=n.parse(e,s),o={"=":r.EQUALITY,"!=":r.INEQUALITY};if(o.hasOwnProperty(s.peak())){var i=s.next(),p=t.exports.parse(e,s);return{type:o[i],lhs:a,rhs:p}}return a}}},{"../expr_type":4,"./relational_expr":20}],10:[function(e,t){"use strict";var r=e("./or_expr");t.exports={parse:function(e){return r.parse(t.exports,e)}}},{"./or_expr":16}],11:[function(e,t){"use strict";var r=e("../expr_type"),n=e("./predicate"),s=e("./primary_expr");t.exports={parse:function(e,t){var a=s.parse(e,t);if("["===t.peak()){for(var o={type:r.FILTER,primary:a,predicates:[]};"["===t.peak();)o.predicates.push(n.parse(e,t));return o}return a},isValidOp:function(e){return s.isValidOp(e)}}},{"../expr_type":4,"./predicate":18,"./primary_expr":19}],12:[function(e,t){"use strict";var r=e("../expr_type");t.exports={parse:function(e,t){var n={type:r.FUNCTION_CALL,name:t.next()};if(t.next(),")"===t.peak())t.next();else{for(n.args=[];")"!==t.peak();)n.args.push(e.parse(t)),","===t.peak()&&t.next();t.next()}return n}}},{"../expr_type":4}],13:[function(e,t){"use strict";var r=e("./absolute_location_path"),n=e("./relative_location_path");t.exports={parse:function(e,t){var s=t.peak(),a=s&&s[0];return"/"===a?r.parse(e,t):n.parse(e,t)}}},{"./absolute_location_path":6,"./relative_location_path":21}],14:[function(e,t){"use strict";var r=e("../expr_type"),n=e("./unary_expr");t.exports={parse:function(e,s){var a=n.parse(e,s),o={"*":r.MULTIPLICATIVE,div:r.DIVISIONAL,mod:r.MODULUS};if(o.hasOwnProperty(s.peak())){var i=s.next(),p=t.exports.parse(e,s);return{type:o[i],lhs:a,rhs:p}}return a}}},{"../expr_type":4,"./unary_expr":23}],15:[function(e,t){"use strict";var r=e("../node_type"),n=e("../validators/node_type");t.exports={parse:function(e,t){if("*"===t.peak())return t.next(),{name:"*"};if("("===t.peak(1)){if(n.isValid(t.peak())){var s={type:t.next()};if(t.next(),s.type===r.PROCESSING_INSTRUCTION){var a=t.peak(),o=a&&a[0];('"'===o||"'"===o)&&(s.name=t.next().slice(1,-1))}if(")"!==t.peak())throw new Error("Invalid token at position "+t.position()+", expected closing parenthesis");return t.next(),s}throw new Error("Invalid node type at position "+t.position())}return{name:t.next()}}}},{"../node_type":5,"../validators/node_type":26}],16:[function(e,t){"use strict";var r=e("../expr_type"),n=e("./and_expr");t.exports={parse:function(e,s){var a=n.parse(e,s);if("or"===s.peak()){s.next();var o=t.exports.parse(e,s);return{type:r.OR,lhs:a,rhs:o}}return a}}},{"../expr_type":4,"./and_expr":8}],17:[function(e,t){"use strict";var r=e("../axis_specifier"),n=e("../expr_type"),s=e("../node_type"),a=e("./filter_expr"),o=e("./location_path"),i=e("./step");t.exports={parse:function(e,t){if(a.isValidOp(t)){var p=a.parse(e,t);if(t.empty()||"/"!==t.peak()[0])return p;for(var u={type:n.PATH,filter:p,steps:[]};!t.empty()&&"/"===t.peak()[0];)"//"===t.next()&&u.steps.push({axis:r.DESCENDANT_OR_SELF,test:{type:s.NODE}}),u.steps.push(i.parse(e,t));return u}return o.parse(e,t)}}},{"../axis_specifier":3,"../expr_type":4,"../node_type":5,"./filter_expr":11,"./location_path":13,"./step":22}],18:[function(e,t){"use strict";t.exports={parse:function(e,t){t.next();var r=e.parse(t);if("]"!==t.peak())throw new Error("Invalid token at position "+t.position()+", expected closing bracket");return t.next(),r}}},{}],19:[function(e,t){"use strict";var r=e("../expr_type"),n=e("../validators/node_type"),s=e("./function_call");t.exports={parse:function(e,t){var a=t.peak(),o=a&&a[0];if("("===o){t.next();var i=e.parse(t);if(")"!==t.peak())throw new Error("Invalid token at position "+t.position()+", expected closing parenthesis");return t.next(),i}if('"'===o||"'"===o)return t.next(),{type:r.LITERAL,string:a.slice(1,-1)};if("$"===o)throw Error("Variable reference are not implemented");return/^\d+$/.test(a)||/^(\d+)?\.\d+$/.test(a)?(t.next(),{type:r.NUMBER,number:parseFloat(a)}):"("!==t.peak(1)||n.isValid(t.peak())?void 0:s.parse(e,t)},isValidOp:function(e){var t=e.peak(),r=t&&t[0];return"("===r||'"'===r||"'"===r||"$"===r||/^\d+$/.test(t)||/^(\d+)?\.\d+$/.test(t)||"("===e.peak(1)&&!n.isValid(e.peak())}}},{"../expr_type":4,"../validators/node_type":26,"./function_call":12}],20:[function(e,t){"use strict";var r=e("../expr_type"),n=e("./additive_expr");t.exports={parse:function(e,s){var a=n.parse(e,s),o={"<":r.LESS_THAN,">":r.GREATER_THAN,"<=":r.LESS_THAN_OR_EQUAL,">=":r.GREATER_THAN_OR_EQUAL};if(o.hasOwnProperty(s.peak())){var i=s.next(),p=t.exports.parse(e,s);return{type:o[i],lhs:a,rhs:p}}return a}}},{"../expr_type":4,"./additive_expr":7}],21:[function(e,t){"use strict";var r=e("../axis_specifier"),n=e("../expr_type"),s=e("../node_type"),a=e("./step");t.exports={parse:function(e,t){var o={type:n.RELATIVE_LOCATION_PATH};for(o.steps=[a.parse(e,t)];!t.empty()&&"/"===t.peak()[0];)"//"===t.next()&&o.steps.push({axis:r.DESCENDANT_OR_SELF,test:{type:s.NODE}}),o.steps.push(a.parse(e,t));return o}}},{"../axis_specifier":3,"../expr_type":4,"../node_type":5,"./step":22}],22:[function(e,t){"use strict";var r=e("../axis_specifier"),n=e("../validators/axis_specifier"),s=e("../node_type"),a=e("./node_test"),o=e("./predicate");t.exports={parse:function(e,t){var i={};if("::"===t.peak(1)){if(!n.isValid(t.peak()))throw new Error("Invalid axis specifier at position "+t.position());i.axis=t.next(),t.next()}else if("@"===t.peak())t.next(),i.axis=r.ATTRIBUTE;else{if(".."===t.peak())return t.next(),{axis:r.PARENT,test:{type:s.NODE}};if("."===t.peak())return t.next(),{axis:r.SELF,test:{type:s.NODE}};i.axis=r.CHILD}for(i.test=a.parse(e,t);"["===t.peak();)i.predicates||(i.predicates=[]),i.predicates.push(o.parse(e,t));return i},isValidOp:function(e){var t=e.peak();return"string"!=typeof t?!1:"."===t||".."===t||"@"===t||"*"===t||/^\w/.test(t)}}},{"../axis_specifier":3,"../node_type":5,"../validators/axis_specifier":25,"./node_test":15,"./predicate":18}],23:[function(e,t){"use strict";var r=e("../expr_type"),n=e("./union_expr");t.exports={parse:function(e,s){return"-"===s.peak()?(s.next(),{type:r.NEGATION,lhs:t.exports.parse(e,s)}):n.parse(e,s)}}},{"../expr_type":4,"./union_expr":24}],24:[function(e,t){"use strict";var r=e("../expr_type"),n=e("./path_expr");t.exports={parse:function(e,s){var a=n.parse(e,s);if("|"===s.peak()){s.next();var o=t.exports.parse(e,s);return{type:r.UNION,lhs:a,rhs:o}}return a}}},{"../expr_type":4,"./path_expr":17}],25:[function(e,t){"use strict";var r=e("../axis_specifier");t.exports={isValid:function(e){for(var t in r)if(r.hasOwnProperty(t)&&r[t]===e)return!0;return!1}}},{"../axis_specifier":3}],26:[function(e,t){"use strict";var r=e("../node_type");t.exports={isValid:function(e){for(var t in r)if(r.hasOwnProperty(t)&&r[t]===e)return!0;return!1}}},{"../node_type":5}],27:[function(e,t){"use strict";function r(e){this.lexer=new n(e)}var n=e("xpath-lexer"),s=e("./axis_specifier"),a=e("./expr_type"),o=e("./node_type"),i=e("./parsers/expr");r.prototype.parse=function(){var e=i.parse(this.lexer);if(this.lexer.empty())return e;throw new Error("Unexpected token at position "+this.lexer.position())},r.AxisSpecifier=s,r.ExprType=a,r.NodeType=o,t.exports=r},{"./axis_specifier":3,"./expr_type":4,"./node_type":5,"./parsers/expr":10,"xpath-lexer":107}],28:[function(e,t){"use strict";t.exports={setAdapter:function(e){this.adapter=e},getAdapter:function(){if(!this.adapter)throw new Error("No adapter is specified");return this.adapter}}},{}],29:[function(e,t){var r=e("xpath-analyzer"),n=e("./axes/ancestor"),s=e("./axes/ancestor_or_self"),a=e("./axes/attribute"),o=e("./axes/child"),i=e("./axes/descendant"),p=e("./axes/descendant_or_self"),u=e("./axes/following"),c=e("./axes/following_sibling"),l=e("./axes/namespace"),f=e("./axes/parent"),x=e("./axes/preceding"),h=e("./axes/preceding_sibling"),_=e("./axes/self");t.exports={},t.exports[r.AxisSpecifier.ANCESTOR]=n,t.exports[r.AxisSpecifier.ANCESTOR_OR_SELF]=s,t.exports[r.AxisSpecifier.ATTRIBUTE]=a,t.exports[r.AxisSpecifier.CHILD]=o,t.exports[r.AxisSpecifier.DESCENDANT]=i,t.exports[r.AxisSpecifier.DESCENDANT_OR_SELF]=p,t.exports[r.AxisSpecifier.FOLLOWING]=u,t.exports[r.AxisSpecifier.FOLLOWING_SIBLING]=c,t.exports[r.AxisSpecifier.NAMESPACE]=l,t.exports[r.AxisSpecifier.PARENT]=f,t.exports[r.AxisSpecifier.PRECEDING]=x,t.exports[r.AxisSpecifier.PRECEDING_SIBLING]=h,t.exports[r.AxisSpecifier.SELF]=_},{"./axes/ancestor":30,"./axes/ancestor_or_self":31,"./axes/attribute":32,"./axes/child":33,"./axes/descendant":34,"./axes/descendant_or_self":35,"./axes/following":36,"./axes/following_sibling":37,"./axes/namespace":38,"./axes/parent":39,"./axes/preceding":40,"./axes/preceding_sibling":41,"./axes/self":42,"xpath-analyzer":27}],30:[function(e,t){"use strict";var r=e("../context"),n=e("../node"),s=e("../types/xpath_node_set");t.exports={evaluate:function(e,t){var a=new s;return t.getNode().getNodeType()!==n.DOCUMENT_NODE&&(a=a.unshift(t.getNode().getParent()),a=a.merge(this.evaluate(e,new r(t.getNode().getParent())))),a}}},{"../context":43,"../node":96,"../types/xpath_node_set":98}],31:[function(e,t){"use strict";var r=e("../types/xpath_node_set"),n=e("./ancestor");t.exports={evaluate:function(e,t){var s=new r([t.getNode()],!0);return n.evaluate(e,t).merge(s)}}},{"../types/xpath_node_set":98,"./ancestor":30}],32:[function(e,t){"use strict";var r=e("../types/xpath_node_set");t.exports={evaluate:function(e,t){return new r(t.getNode().getAttributes())}}},{"../types/xpath_node_set":98}],33:[function(e,t){"use strict";var r=e("../types/xpath_node_set");t.exports={evaluate:function(e,t){return new r(t.getNode().getChildNodes())}}},{"../types/xpath_node_set":98}],34:[function(e,t){"use strict";var r=e("../context"),n=e("../types/xpath_node_set");t.exports={evaluate:function(e,t){for(var s,a=new n,o=new n(t.getNode().getChildNodes()),i=o.iterator();s=i.next();)a=a.push(s),a=a.merge(this.evaluate(e,new r(s)));return a}}},{"../context":43,"../types/xpath_node_set":98}],35:[function(e,t){"use strict";var r=e("../types/xpath_node_set"),n=e("./descendant");t.exports={evaluate:function(e,t){var s=new r([t.getNode()]);return s.merge(n.evaluate(e,t))}}},{"../types/xpath_node_set":98,"./descendant":34}],36:[function(e,t){"use strict";var r=e("xpath-analyzer");t.exports={evaluate:function(e,t){return e.evaluate({type:r.ExprType.RELATIVE_LOCATION_PATH,steps:[{axis:r.AxisSpecifier.ANCESTOR_OR_SELF,test:{type:r.NodeType.NODE}},{axis:r.AxisSpecifier.FOLLOWING_SIBLING,test:{type:r.NodeType.NODE}},{axis:r.AxisSpecifier.DESCENDANT_OR_SELF,test:{type:r.NodeType.NODE}}]},t)}}},{"xpath-analyzer":27}],37:[function(e,t){"use strict";var r=e("../types/xpath_node_set");t.exports={evaluate:function(e,t){return new r(t.getNode().getFollowingSiblings())}}},{"../types/xpath_node_set":98}],38:[function(){},{}],39:[function(e,t){"use strict";var r=e("../node"),n=e("../types/xpath_node_set");t.exports={evaluate:function(e,t){var s=new n;return t.getNode().getNodeType()!==r.DOCUMENT_NODE&&(s=s.push(t.getNode().getParent())),s}}},{"../node":96,"../types/xpath_node_set":98}],40:[function(e,t){"use strict";var r=e("xpath-analyzer");t.exports={evaluate:function(e,t){return e.evaluate({type:r.ExprType.RELATIVE_LOCATION_PATH,steps:[{axis:r.AxisSpecifier.ANCESTOR_OR_SELF,test:{type:r.NodeType.NODE}},{axis:r.AxisSpecifier.PRECEDING_SIBLING,test:{type:r.NodeType.NODE}},{axis:r.AxisSpecifier.DESCENDANT_OR_SELF,test:{type:r.NodeType.NODE}}]},t)}}},{"xpath-analyzer":27}],41:[function(e,t){"use strict";var r=e("../types/xpath_node_set");t.exports={evaluate:function(e,t){return new r(t.getNode().getPrecedingSiblings())}}},{"../types/xpath_node_set":98}],42:[function(e,t){"use strict";var r=e("../types/xpath_node_set");t.exports={evaluate:function(e,t){return new r([t.getNode()])}}},{"../types/xpath_node_set":98}],43:[function(e,t){"use strict";function r(e,t,r){this.node=e,this.position=t,this.last=r}r.prototype.getNode=function(){return this.node},r.prototype.getPosition=function(){return this.position},r.prototype.getLast=function(){return this.last},r.prototype.toString=function(){return"Context<"+this.node+">"},t.exports=r},{}],44:[function(e,t){var r=e("xpath-analyzer"),n=e("./evaluators/absolute_location_path"),s=e("./evaluators/additive"),a=e("./evaluators/and"),o=e("./evaluators/divisional"),i=e("./evaluators/equality"),p=e("./evaluators/filter"),u=e("./evaluators/function_call"),c=e("./evaluators/greater_than"),l=e("./evaluators/greater_than_or_equal"),f=e("./evaluators/inequality"),x=e("./evaluators/less_than"),h=e("./evaluators/less_than_or_equal"),_=e("./evaluators/literal"),v=e("./evaluators/modulus"),E=e("./evaluators/multiplicative"),y=e("./evaluators/negation"),d=e("./evaluators/number"),N=e("./evaluators/or"),g=e("./evaluators/path"),T=e("./evaluators/relative_location_path"),w=e("./evaluators/subtractive"),m=e("./evaluators/union");t.exports={},t.exports[r.ExprType.ABSOLUTE_LOCATION_PATH]=n,t.exports[r.ExprType.ADDITIVE]=s,t.exports[r.ExprType.AND]=a,t.exports[r.ExprType.DIVISIONAL]=o,t.exports[r.ExprType.EQUALITY]=i,t.exports[r.ExprType.FILTER]=p,t.exports[r.ExprType.FUNCTION_CALL]=u,t.exports[r.ExprType.GREATER_THAN]=c,t.exports[r.ExprType.GREATER_THAN_OR_EQUAL]=l,t.exports[r.ExprType.INEQUALITY]=f,t.exports[r.ExprType.LESS_THAN]=x,t.exports[r.ExprType.LESS_THAN_OR_EQUAL]=h,t.exports[r.ExprType.LITERAL]=_,t.exports[r.ExprType.MODULUS]=v,t.exports[r.ExprType.MULTIPLICATIVE]=E,t.exports[r.ExprType.NEGATION]=y,t.exports[r.ExprType.NUMBER]=d,t.exports[r.ExprType.OR]=N,t.exports[r.ExprType.PATH]=g,t.exports[r.ExprType.RELATIVE_LOCATION_PATH]=T,t.exports[r.ExprType.SUBTRACTIVE]=w,t.exports[r.ExprType.UNION]=m},{"./evaluators/absolute_location_path":45,"./evaluators/additive":46,"./evaluators/and":47,"./evaluators/divisional":48,"./evaluators/equality":49,"./evaluators/filter":50,"./evaluators/function_call":51,"./evaluators/greater_than":52,"./evaluators/greater_than_or_equal":53,"./evaluators/inequality":55,"./evaluators/less_than":56,"./evaluators/less_than_or_equal":57,"./evaluators/literal":58,"./evaluators/modulus":59,"./evaluators/multiplicative":60,"./evaluators/negation":61,"./evaluators/number":62,"./evaluators/or":63,"./evaluators/path":64,"./evaluators/relative_location_path":65,"./evaluators/subtractive":67,"./evaluators/union":68,"xpath-analyzer":27}],45:[function(e,t){"use strict";var r=e("../context"),n=e("../node"),s=e("./relative_location_path");t.exports={evaluate:function(e,t,a,o){return a.getNode().getNodeType()!==n.DOCUMENT_NODE&&(a=new r(a.getNode().getOwnerDocument())),s.evaluate(e,t,a,o)}}},{"../context":43,"../node":96,"./relative_location_path":65}],46:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e,t,n,s){var a=e.evaluate(t.lhs,n,s),o=e.evaluate(t.rhs,n,s);return new r(a.asNumber()+o.asNumber())}}},{"../types/xpath_number":99}],47:[function(e,t){"use strict";var r=e("../types/xpath_boolean");t.exports={evaluate:function(e,t,n,s){var a=e.evaluate(t.lhs,n,s);return a.asBoolean()?e.evaluate(t.rhs,n,s):new r(!1)}}},{"../types/xpath_boolean":97}],48:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e,t,n,s){var a=e.evaluate(t.lhs,n,s),o=e.evaluate(t.rhs,n,s);return new r(a.asNumber()/o.asNumber())}}},{"../types/xpath_number":99}],49:[function(e,t){"use strict";var r=e("./helper");t.exports={evaluate:function(e,t,n,s){return r.compareNodes(t.type,e.evaluate(t.lhs,n,s),e.evaluate(t.rhs,n,s),function(e,t){return e===t})}}},{"./helper":54}],50:[function(e,t){"use strict";var r=e("../context"),n=e("../types/xpath_number"),s=e("../types/xpath_node_set");t.exports={evaluate:function(e,t,a,o){for(var i,p=e.evaluate(t.primary,a,o),u=0,c=[],l=p.iterator();i=l.next();){u++;var f=t.predicates.every(function(t){var s=e.evaluate(t,new r(i,u,p.length()),o);return null===s?!1:s instanceof n?s.asNumber()===u:s.asBoolean()});f&&c.push(i)}return new s(c)}}},{"../context":43,"../types/xpath_node_set":98,"../types/xpath_number":99}],51:[function(e,t){"use strict";var r=e("../functions");t.exports={evaluate:function(e,t,n,s){var a=(t.args||[]).map(function(t){return e.evaluate(t,n,s)});a.unshift(n);var o=r[t.name];if(o)return o.evaluate.apply(null,a);throw new Error("Unknown function "+t.name)}}},{"../functions":69}],52:[function(e,t){"use strict";var r=e("./helper");t.exports={evaluate:function(e,t,n,s){return r.compareNodes(t.type,e.evaluate(t.lhs,n,s),e.evaluate(t.rhs,n,s),function(e,t){return e>t})}}},{"./helper":54}],53:[function(e,t){"use strict";var r=e("./helper");t.exports={evaluate:function(e,t,n,s){return r.compareNodes(t.type,e.evaluate(t.lhs,n,s),e.evaluate(t.rhs,n,s),function(e,t){return e>=t})}}},{"./helper":54}],54:[function(e,t){"use strict";var r=e("xpath-analyzer"),n=e("../types/xpath_boolean"),s=e("../types/xpath_node_set"),a=e("../types/xpath_number"),o=e("../types/xpath_string");t.exports={compareNodes:function(e,t,i,p){if(t instanceof s&&i instanceof s){for(var u,c=t.iterator();u=c.next();)for(var l,f=i.iterator();l=f.next();)if(p(u.asString(),l.asString()))return new n(!0);return new n(!1)}if(t instanceof s||i instanceof s){var x,h;t instanceof s?(x=t,h=i):(x=i,h=t);for(var _,v=x.iterator();_=v.next();)if(h instanceof a){if(p(_.asNumber(),h.asNumber()))return new n(!0)}else if(h instanceof n){if(p(_.asBoolean(),h.asBoolean()))return new n(!0)}else{if(!(h instanceof o))throw new Error("Unknown value type");if(p(_.asString(),h.asString()))return new n(!0)}return new n(!1)}if(e===r.ExprType.EQUALITY||e===r.ExprType.INEQUALITY){if(t instanceof n||i instanceof n){if(p(t.asBoolean(),i.asBoolean()))return new n(!0)}else if(i instanceof a||i instanceof a){if(p(t.asNumber(),i.asNumber()))return new n(!0)}else{if(!(i instanceof o||i instanceof o))throw new Error("Unknown value types");if(p(t.asString(),i.asString()))return new n(!0)}return new n(!1)}return new n(p(t.asNumber(),i.asNumber()))}}},{"../types/xpath_boolean":97,"../types/xpath_node_set":98,"../types/xpath_number":99,"../types/xpath_string":100,"xpath-analyzer":27}],55:[function(e,t){"use strict";var r=e("./helper");t.exports={evaluate:function(e,t,n,s){return r.compareNodes(t.type,e.evaluate(t.lhs,n,s),e.evaluate(t.rhs,n,s),function(e,t){return e!==t})}}},{"./helper":54}],56:[function(e,t){"use strict";var r=e("./helper");t.exports={evaluate:function(e,t,n,s){return r.compareNodes(t.type,e.evaluate(t.lhs,n,s),e.evaluate(t.rhs,n,s),function(e,t){return t>e})}}},{"./helper":54}],57:[function(e,t){"use strict";var r=e("./helper");t.exports={evaluate:function(e,t,n,s){return r.compareNodes(t.type,e.evaluate(t.lhs,n,s),e.evaluate(t.rhs,n,s),function(e,t){return t>=e})}}},{"./helper":54}],58:[function(e,t){"use strict";var r=e("../types/xpath_string");t.exports={evaluate:function(e,t){return new r(t.string)}}},{"../types/xpath_string":100}],59:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e,t,n,s){var a=e.evaluate(t.lhs,n,s),o=e.evaluate(t.rhs,n,s);return new r(a.asNumber()%o.asNumber())}}},{"../types/xpath_number":99}],60:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e,t,n,s){var a=e.evaluate(t.lhs,n,s),o=e.evaluate(t.rhs,n,s);return new r(a.asNumber()*o.asNumber())}}},{"../types/xpath_number":99}],61:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e,t,n,s){var a=e.evaluate(t.lhs,n,s);return new r(-a.asNumber())}}},{"../types/xpath_number":99}],62:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e,t){return new r(t.number)}}},{"../types/xpath_number":99}],63:[function(e,t){"use strict";var r=e("../types/xpath_boolean");t.exports={evaluate:function(e,t,n,s){var a=e.evaluate(t.lhs,n,s);return a.asBoolean()?new r(!0):e.evaluate(t.rhs,n,s)}}},{"../types/xpath_boolean":97}],64:[function(e,t){"use strict";var r=e("../context"),n=e("./relative_location_path");t.exports={evaluate:function(e,t,s,a){var o=e.evaluate(t.filter,s,a);if(t.steps){for(var i,p=[],u=o.iterator();i=u.next();)p.push(n.evaluate(e,t,new r(i),a));o=p.reduce(function(e,t){return e.merge(t)})}return o}}},{"../context":43,"./relative_location_path":65}],65:[function(e,t){"use strict";var r=e("../context"),n=e("../types/xpath_node_set"),s=e("./step");t.exports={evaluate:function(e,t,a,o){var i=new n([a.getNode()]),p=new n;if(t.steps)for(var u=0;u<t.steps.length;u++){for(var c,l=i.iterator();c=l.next();){var f=s.evaluate(e,t.steps[u],new r(c),o);p=p.merge(f)}i=p,p=new n}return i}}},{"../context":43,"../types/xpath_node_set":98,"./step":66}],66:[function(e,t){"use strict";var r=e("xpath-analyzer"),n=e("../axes"),s=e("../context"),a=e("../types/xpath_number"),o=e("../types/xpath_node_set"),i=e("../node");t.exports={evaluate:function(e,t,p,u){var c,l=n[t.axis];if(!l)throw new Error("Unknown axis specifier "+t.axis);if(c=l.evaluate(e,p,u),t.test.name){var f=t.test.name;c=c.filter(function(e){return"*"===f&&e.getName()||e.getName()===t.test.name})}if(t.test.type&&t.test.type!==r.NodeType.NODE){var x;switch(t.test.type){case r.NodeType.COMMENT:x=i.COMMENT_NODE;break;case r.NodeType.PROCESSING_INSTRUCTION:x=i.PROCESSING_INSTRUCTION_NODE;break;case r.NodeType.TEXT:x=i.TEXT_NODE;break;default:throw new Error("Unknown node nodeType "+t.test.nodeType)}c=c.filter(function(e){return e.getNodeType()===x})}if(t.predicates){for(var h,_=t.axis===r.AxisSpecifier.ANCESTOR||t.axis===r.AxisSpecifier.ANCESTOR_OR_SELF||t.axis===r.AxisSpecifier.PRECEDING||t.axis===r.AxisSpecifier.PRECEDING_SIBLING,v=0,E=[],y=c.iterator(_);h=y.next();){v++;var d=t.predicates.every(function(t){var r=e.evaluate(t,new s(h,v,c.length()),u);return null===r?!1:r instanceof a?r.asNumber()===v:r.asBoolean()});d&&E.push(h)}c=new o(E)}return c}}},{"../axes":29,"../context":43,"../node":96,"../types/xpath_node_set":98,"../types/xpath_number":99,"xpath-analyzer":27}],67:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e,t,n,s){var a=e.evaluate(t.lhs,n,s),o=e.evaluate(t.rhs,n,s);return new r(a.asNumber()-o.asNumber())}}},{"../types/xpath_number":99}],68:[function(e,t){"use strict";t.exports={evaluate:function(e,t,r,n){var s=e.evaluate(t.lhs,r,n),a=e.evaluate(t.rhs,r,n);return s.merge(a)}}},{}],69:[function(e,t){var r=e("./functions/boolean"),n=e("./functions/ceiling"),s=e("./functions/concat"),a=e("./functions/contains"),o=e("./functions/count"),i=e("./functions/false"),p=e("./functions/floor"),u=e("./functions/id"),c=e("./functions/last"),l=e("./functions/local_name"),f=e("./functions/name"),x=e("./functions/normalize_space"),h=e("./functions/not"),_=e("./functions/number"),v=e("./functions/position"),E=e("./functions/round"),y=e("./functions/starts_with"),d=e("./functions/string_length"),N=e("./functions/string"),g=e("./functions/substring_after"),T=e("./functions/substring_before"),w=e("./functions/substring"),m=e("./functions/sum"),O=e("./functions/translate"),R=e("./functions/true");t.exports={},t.exports["boolean"]=r,t.exports.ceiling=n,t.exports.concat=s,t.exports.contains=a,t.exports.count=o,t.exports["false"]=i,t.exports.floor=p,t.exports.id=u,t.exports.last=c,t.exports["local-name"]=l,t.exports.name=f,t.exports["normalize-space"]=x,t.exports.not=h,t.exports.number=_,t.exports.position=v,t.exports.round=E,t.exports["starts-with"]=y,t.exports["string-length"]=d,t.exports.string=N,t.exports["substring-after"]=g,t.exports["substring-before"]=T,t.exports.substring=w,t.exports.sum=m,t.exports.translate=O,t.exports["true"]=R},{"./functions/boolean":70,"./functions/ceiling":71,"./functions/concat":72,"./functions/contains":73,"./functions/count":74,"./functions/false":75,"./functions/floor":76,"./functions/id":77,"./functions/last":78,"./functions/local_name":79,"./functions/name":80,"./functions/normalize_space":81,"./functions/not":82,"./functions/number":83,"./functions/position":84,"./functions/round":85,"./functions/starts_with":86,"./functions/string":87,"./functions/string_length":88,"./functions/substring":89,"./functions/substring_after":90,"./functions/substring_before":91,"./functions/sum":92,"./functions/translate":93,"./functions/true":94}],70:[function(e,t){"use strict";var r=e("../types/xpath_boolean");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");return new r(t.asBoolean())}}},{"../types/xpath_boolean":97}],71:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");return new r(Math.ceil(t.asNumber()))}}},{"../types/xpath_number":99}],72:[function(e,t){"use strict";var r=e("../types/xpath_string");t.exports={evaluate:function(){var e=[].slice.call(arguments);if(e.shift(),0===e.length)throw new Error("Expected some arguments");return e=e.map(function(e){return e.asString()}),new r(e.join(""))}}},{"../types/xpath_string":100}],73:[function(e,t){"use strict";var r=e("../types/xpath_boolean");t.exports={evaluate:function(e,t,n){if(!n)throw new Error("Expected two arguments");return t=t.asString(),n=n.asString(),new r(-1!==t.indexOf(n))}}},{"../types/xpath_boolean":97}],74:[function(e,t){"use strict";var r=e("../types/xpath_node_set"),n=e("../types/xpath_number");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");return new n(t.length())}}},{"../types/xpath_node_set":98,"../types/xpath_number":99}],75:[function(e,t){"use strict";var r=e("../types/xpath_boolean");t.exports={evaluate:function(){return new r(!1)}}},{"../types/xpath_boolean":97}],76:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");return new r(Math.floor(t.asNumber()))}}},{"../types/xpath_number":99}],77:[function(e,t){"use strict";var r=e("../node"),n=e("../types/xpath_node_set"),s=e("../types/xpath_string");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");var a,o=[];if(t instanceof n)for(var i=t.iterator();a=i.next();)o=o.concat(a.asString().split(/\s+/g));
else t instanceof s?o=t.asString().split(/\s+/g):o.push(t.asString());for(var p=new n,u=0;u<o.length;u++)a=e.getNode().getNodeType()===r.DOCUMENT_NODE?e.getNode().getElementById(o[u]):e.getNode().getOwnerDocument().getElementById(o[u]),a&&(p=p.merge(new n([a])));return p}}},{"../node":96,"../types/xpath_node_set":98,"../types/xpath_string":100}],78:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e){return new r(e.getLast())}}},{"../types/xpath_number":99}],79:[function(e,t){"use strict";var r=e("../types/xpath_node_set"),n=e("../types/xpath_string");t.exports={evaluate:function(e,t){if(t||(t=new r([e.getNode()])),arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");return new n(t.empty()?"":t.first().getName())}}},{"../types/xpath_node_set":98,"../types/xpath_string":100}],80:[function(e,t){"use strict";var r=e("../types/xpath_string"),n=e("../types/xpath_node_set");t.exports={evaluate:function(e,t){if(t){if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof n))throw new Error("Wrong type of argument");return new r(t.empty()?"":t.first().getName())}return new r(e.getNode().getName())}}},{"../types/xpath_node_set":98,"../types/xpath_string":100}],81:[function(e,t){"use strict";var r=e("../types/xpath_string");t.exports={evaluate:function(e,t){var n;if(t){if(arguments.length>2)throw new Error("Unknown argument(s)");n=t.asString()}else n=e.getNode().asString();return new r(n.trim().replace(/\s{2,}/g," "))}}},{"../types/xpath_string":100}],82:[function(e,t){"use strict";var r=e("../types/xpath_boolean");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");return new r(!t.asBoolean())}}},{"../types/xpath_boolean":97}],83:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");return new r(t.asNumber())}}},{"../types/xpath_number":99}],84:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e){return new r(e.getPosition())}}},{"../types/xpath_number":99}],85:[function(e,t){"use strict";var r=e("../types/xpath_number");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");return new r(Math.round(t.asNumber()))}}},{"../types/xpath_number":99}],86:[function(e,t){"use strict";var r=e("../types/xpath_boolean");t.exports={evaluate:function(e,t,n){if(!n)throw new Error("Expected two arguments");t=t.asString(),n=n.asString();var s=t.indexOf(n);return new r(0===s)}}},{"../types/xpath_boolean":97}],87:[function(e,t){"use strict";var r=e("../types/xpath_node_set"),n=e("../types/xpath_string");t.exports={evaluate:function(e,t){if(t||(t=new r([e.getNode()])),arguments.length>2)throw new Error("Unknown argument(s)");return new n(t.asString())}}},{"../types/xpath_node_set":98,"../types/xpath_string":100}],88:[function(e,t){"use strict";var r=e("../types/xpath_string"),n=e("../types/xpath_number");t.exports={evaluate:function(e,t){if(t){if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");t=t.asString()}else t=e.getNode().asString();return new n(t.length)}}},{"../types/xpath_number":99,"../types/xpath_string":100}],89:[function(e,t){"use strict";var r=e("../types/xpath_string");t.exports={evaluate:function(e,t,n,s){if(!n)throw new Error("Expected two or three arguments");return t=t.asString(),n=Math.round(n.asNumber()),new r(isNaN(n)||n===1/0||n===-(1/0)?"":s&&(s=Math.round(s.asNumber()),isNaN(s)||s===-(1/0))?"":s?t.substring(n-1,n+s-1):t.substring(n-1))}}},{"../types/xpath_string":100}],90:[function(e,t){"use strict";var r=e("../types/xpath_string");t.exports={evaluate:function(e,t,n){if(!n)throw new Error("Expected two arguments");t=t.asString(),n=n.asString();var s=t.indexOf(n);return new r(-1===s?"":t.substring(s+n.length))}}},{"../types/xpath_string":100}],91:[function(e,t){"use strict";var r=e("../types/xpath_string");t.exports={evaluate:function(e,t,n){if(!n)throw new Error("Expected two arguments");t=t.asString(),n=n.asString();var s=t.indexOf(n);return new r(-1===s?"":t.substring(0,s))}}},{"../types/xpath_string":100}],92:[function(e,t){"use strict";var r=e("../types/xpath_node_set"),n=e("../types/xpath_number");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");for(var s,a=0,o=t.iterator();s=o.next();)a+=s.asNumber();return new n(a)}}},{"../types/xpath_node_set":98,"../types/xpath_number":99}],93:[function(e,t){"use strict";var r=e("../types/xpath_string");t.exports={evaluate:function(e,t,n,s){if(!s)throw new Error("Expected three arguments");if(!(t instanceof r&&n instanceof r&&s instanceof r))throw new Error("Expected string arguments");t=t.asString(),n=n.asString(),s=s.asString();for(var a=0;a<n.length;a++)t=a<s.length?t.replace(new RegExp(n[a],"g"),s[a]):t.replace(new RegExp(n[a],"g"),"");return new r(t)}}},{"../types/xpath_string":100}],94:[function(e,t){"use strict";var r=e("../types/xpath_boolean");t.exports={evaluate:function(){return new r(!0)}}},{"../types/xpath_boolean":97}],95:[function(e,t){"use strict";function r(e,t){this.list=e,this.reversed=t,this.current=t?e.last_:e.first_,this.lastReturned=null,this.i=0}r.prototype.next=function(){if(this.i++,this.i>1e4)throw new Error("An error has probably ocurred!");return this.current?(this.lastReturned=this.current,this.current=this.reversed?this.current.previous:this.current.next,this.lastReturned.node):void 0},r.prototype.remove=function(){if(!this.lastReturned)throw new Error("remove was called before iterating!");var e=this.lastReturned.next,t=this.lastReturned.previous;e?e.previous=t:this.list.last_=t,t?t.next=e:this.list.first_=e,this.lastReturned=null,this.list.length_--},t.exports=r},{}],96:[function(e,t){t.exports={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}},{}],97:[function(e,t){"use strict";function r(e){this.value=e}r.prototype.asString=function(){return""+this.value},r.prototype.asNumber=function(){return this.value?1:0},r.prototype.asBoolean=function(){return this.value},t.exports=r},{}],98:[function(e,t){"use strict";function r(e){this.node=e}function n(e){this.first_=null,this.last_=null,this.length_=0,e&&e.forEach(function(e){this.push(e)},this)}var s=e("../adapter"),a=e("../iterator");n.prototype.iterator=function(e){return new a(this,e)},n.prototype.first=function(){return this.first_.node},n.prototype.last=function(){return this.last_.node},n.prototype.length=function(){return this.length_},n.prototype.empty=function(){return 0===this.length()},n.prototype.asString=function(){return this.empty()?"":this.first().asString()},n.prototype.asNumber=function(){return+this.asString()},n.prototype.asBoolean=function(){return 0!==this.length()},n.prototype.merge=function(e){return n.merge(this,e)},n.prototype.push=function(e){var t=new r(e);return t.next=null,t.previous=this.last_,this.first_?this.last_.next=t:this.first_=t,this.last_=t,this.length_++,this},n.prototype.unshift=function(e){var t=new r(e);return t.previous=null,t.next=this.first_,this.first_?this.first_.previous=t:this.last_=t,this.first_=t,this.length_++,this},n.prototype.filter=function(e){for(var t,r=this.iterator();t=r.next();)e(t)||r.remove();return this},n.merge=function(e,t){var r=s.getAdapter().compareDocumentPosition;return r?n.mergeWithOrder(e,t,r):n.mergeWithoutOrder(e,t)},n.mergeWithOrder=function(e,t,r){if(!e.first_)return t;if(!t.first_)return e;for(var n=e.first_,s=t.first_,a=e,o=null,i=null,p=0;n&&s;){if(n.node.isEqual(s.node))i=n,n=n.next,s=s.next;else{var u=r(n.node,s.node);u>0?(i=s,s=s.next):(i=n,n=n.next)}i.previous=o,o?o.next=i:a.first_=i,o=i,p++}for(i=n||s;i;)i.previous=o,o.next=i,o=i,p++,i=i.next;return a.last_=o,a.length_=p,a},n.mergeWithoutOrder=function(e,t){for(var r,s=[],a=e.iterator();r=a.next();)s.push(r);for(a=t.iterator();r=a.next();){var o=s.every(function(e){return!e.isEqual(r)});o&&s.push(r)}return new n(s)},n.prototype.toString=function(){for(var e,t=this.iterator(),r=[];e=t.next();)r.push(""+e);return"NodeSet<"+r.join(", ")+">"},t.exports=n},{"../adapter":28,"../iterator":95}],99:[function(e,t){"use strict";function r(e){this.value=e}r.prototype.asString=function(){return""+this.value},r.prototype.asNumber=function(){return this.value},r.prototype.asBoolean=function(){return!!this.value},t.exports=r},{}],100:[function(e,t){"use strict";function r(e){this.value=e}r.prototype.asString=function(){return this.value},r.prototype.asNumber=function(){return+this.value},r.prototype.asBoolean=function(){return 0!==this.value.length},t.exports=r},{}],101:[function(e,t){"use strict";function r(){throw new Error("Namespaces are not implemented")}var n=e("./xpath_expression"),s=e("./xpath_result"),a=e("./adapter"),o=e("./node");t.exports={evaluate:function(e,t,n,o){n&&r();var i=this.createExpression(e).evaluate(t,o,a.getAdapter());return new s(o,i)},createExpression:function(e,t){return t&&r(),new n(e)},createNSResolver:function(){r()},setAdapter:function(e){a.setAdapter(e)},XPathResult:s,Node:o}},{"./adapter":28,"./node":96,"./xpath_expression":104,"./xpath_result":105}],102:[function(e,t){"use strict";function r(e,t){this.code=e,this.message=t}t.exports=r},{}],103:[function(e,t){t.exports={INVALID_EXPRESSION_ERR:51,TYPE_ERR:52}},{}],104:[function(e,t){"use strict";function r(e){this.expression=e}var n=e("xpath-analyzer"),s=e("./context"),a=e("./evaluators");r.evaluate=function(e,t,n){var s=a[e.type];return s.evaluate(r,e,t,n)},r.prototype.evaluate=function(e,t,a){var o=new n(this.expression).parse();return r.evaluate(o,new s(new a(e)),t)},t.exports=r},{"./context":43,"./evaluators":44,"xpath-analyzer":27}],105:[function(e,t){"use strict";function r(e,t){if(this.value=t,e===a.ANY_TYPE)if(t instanceof o)this.resultType=a.UNORDERED_NODE_ITERATOR_TYPE;else if(t instanceof i)this.resultType=a.STRING_TYPE;else if(t instanceof p)this.resultType=a.NUMBER_TYPE;else{if(!(t instanceof u))throw new Error("Unexpected evaluation result");this.resultType=a.BOOLEAN_TYPE}else this.resultType=e;if(this.resultType!==a.STRING_TYPE&&this.resultType!==a.NUMBER_TYPE&&this.resultType!==a.BOOLEAN_TYPE&&!(t instanceof o))throw Error("Value could not be converted to the specified type");if(this.resultType===a.UNORDERED_NODE_ITERATOR_TYPE||this.resultType===a.ORDERED_NODE_ITERATOR_TYPE||this.resultType===a.UNORDERED_NODE_SNAPSHOT_TYPE||this.resultType===a.ORDERED_NODE_SNAPSHOT_TYPE){this.nodes=[];for(var r,c=this.value.iterator();r=c.next();)this.nodes.push(r.getNativeNode())}var l=this,f=!0;try{Object.defineProperty({},"x",{})}catch(x){f=!1}f?(Object.defineProperty(this,"numberValue",{get:function(){if(l.resultType!==a.NUMBER_TYPE)throw new n(s.TYPE_ERR,"resultType is not NUMBER_TYPE");return l.value.asNumber()}}),Object.defineProperty(this,"stringValue",{get:function(){if(l.resultType!==a.STRING_TYPE)throw new n(s.TYPE_ERR,"resultType is not STRING_TYPE");return l.value.asString()}}),Object.defineProperty(this,"booleanValue",{get:function(){if(l.resultType!==a.BOOLEAN_TYPE)throw new n(s.TYPE_ERR,"resultType is not BOOLEAN_TYPE");return l.value.asBoolean()}}),Object.defineProperty(this,"singleNodeValue",{get:function(){if(l.resultType!==a.FIRST_ORDERED_NODE_TYPE&&l.resultType!==a.ANY_UNORDERED_NODE_TYPE)throw new n(s.TYPE_ERR,"resultType is not a node set");return l.value.empty()?null:l.value.first().getNativeNode()}}),Object.defineProperty(this,"invalidIteratorState",{get:function(){throw new Error("invalidIteratorState is not implemented")}}),Object.defineProperty(this,"snapshotLength",{get:function(){if(l.resultType!==a.ORDERED_NODE_SNAPSHOT_TYPE&&l.resultType!==a.UNORDERED_NODE_SNAPSHOT_TYPE)throw new n(s.TYPE_ERR,"resultType is not a node set");return l.value.length()}})):(l.resultType===a.NUMBER_TYPE&&(l.numberValue=l.value.asNumber()),l.resultType===a.STRING_TYPE&&(l.stringValue=l.value.asString()),l.resultType===a.BOOLEAN_TYPE&&(l.booleanValue=l.value.asBoolean()),(l.resultType===a.FIRST_ORDERED_NODE_TYPE||l.resultType===a.ANY_UNORDERED_NODE_TYPE)&&(l.singleNodeValue=l.value.empty()?null:l.value.first().getNativeNode()),(l.resultType===a.ORDERED_NODE_SNAPSHOT_TYPE||l.resultType===a.UNORDERED_NODE_SNAPSHOT_TYPE)&&(l.snapshotLength=l.value.length()))}var n=e("./xpath_exception"),s=e("./xpath_exception_code"),a=e("./xpath_result_type"),o=e("./types/xpath_node_set"),i=e("./types/xpath_string"),p=e("./types/xpath_number"),u=e("./types/xpath_boolean");r.prototype.iterateNext=function(){if(this.resultType!==a.ORDERED_NODE_ITERATOR_TYPE&&this.resultType!==a.UNORDERED_NODE_ITERATOR_TYPE)throw new n(s.TYPE_ERR,"iterateNext called with wrong result type");return this.index=this.index||0,this.index>=this.nodes.length?null:this.nodes[this.index++]},r.prototype.snapshotItem=function(e){if(this.resultType!==a.ORDERED_NODE_SNAPSHOT_TYPE&&this.resultType!==a.UNORDERED_NODE_SNAPSHOT_TYPE)throw new n(s.TYPE_ERR,"snapshotItem called with wrong result type");return this.nodes[e]||null};for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c]);t.exports=r},{"./types/xpath_boolean":97,"./types/xpath_node_set":98,"./types/xpath_number":99,"./types/xpath_string":100,"./xpath_exception":102,"./xpath_exception_code":103,"./xpath_result_type":106}],106:[function(e,t){t.exports={ANY_TYPE:0,NUMBER_TYPE:1,STRING_TYPE:2,BOOLEAN_TYPE:3,UNORDERED_NODE_ITERATOR_TYPE:4,ORDERED_NODE_ITERATOR_TYPE:5,UNORDERED_NODE_SNAPSHOT_TYPE:6,ORDERED_NODE_SNAPSHOT_TYPE:7,ANY_UNORDERED_NODE_TYPE:8,FIRST_ORDERED_NODE_TYPE:9}},{}],107:[function(e,t){"use strict";function r(e){var t=e.match(n);if(null===t)throw new Error("Invalid character at position 0");if(t.join("")!==e){for(var r=0;e.indexOf(t[0])===r;)r+=t.shift().length;throw new Error("Invalid character at position "+r)}this.tokens=t.map(function(e){return{value:e,position:0}}),this.tokens.reduce(function(e,t){return t.position=e.position+e.value.length,t}),this.tokens=this.tokens.filter(function(e){return!/^\s+$/.test(e.value)}),this.index=0}var n=new RegExp(["\\$?(?:(?![0-9-])[\\w-]+:)?(?![0-9-])[\\w-]+","\\d+\\.\\d+","\\.\\d+","\\d+","\\/\\/","/","\\.\\.","\\.","\\s+","::",",","@","-","=","!=","<=","<",">=",">","\\|","\\+","\\*","\\(","\\)","\\[","\\]",'"[^"]*"',"'[^']*'"].join("|"),"g");r.prototype.length=function(){return this.tokens.length},r.prototype.next=function(){if(this.index===this.tokens.length)return null;var e=this.tokens[this.index++];return e&&e.value},r.prototype.back=function(){this.index>0&&this.index--},r.prototype.peak=function(e){var t=this.tokens[this.index+(e||0)];return t&&t.value},r.prototype.empty=function(){return this.tokens.length<=this.index},r.prototype.position=function(){if(this.index===this.tokens.length){var e=this.tokens[this.index-1];return e.position+e.value.length}return this.tokens[this.index].position},t.exports=r},{}],108:[function(e,t){var r=e("xpath-evaluator"),n=e("./lib/xpath_dom");r.setAdapter(n),t.exports=r},{"./lib/xpath_dom":2,"xpath-evaluator":101}]},{},[1])(1)});
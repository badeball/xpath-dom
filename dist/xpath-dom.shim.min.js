!function(){"use strict";var e=new RegExp(["\\$?(?:(?![0-9-])[\\w-]+:)?(?![0-9-])[\\w-]+","\\d+\\.\\d+","\\.\\d+","\\d+","\\/\\/","/","\\.\\.","\\.","\\s+","::",",","@","-","=","!=","<=","<",">=",">","\\|","\\+","\\*","\\(","\\)","\\[","\\]",'"[^"]*"',"'[^']*'"].join("|"),"g");function t(t){var n=t.match(e);if(null===n)throw new Error("Invalid character at position 0");if(n.join("")!==t){for(var r=0;t.indexOf(n[0])===r;)r+=n.shift().length;throw new Error("Invalid character at position "+r)}this.tokens=n.map(function(e){return{value:e,position:0}}),this.tokens.reduce(function(e,t){return t.position=e.position+e.value.length,t}),this.tokens=this.tokens.filter(function(e){return!/^\s+$/.test(e.value)}),this.index=0}t.prototype.length=function(){return this.tokens.length},t.prototype.next=function(){if(this.index===this.tokens.length)return null;var e=this.tokens[this.index++];return e&&e.value},t.prototype.back=function(){this.index>0&&this.index--},t.prototype.peak=function(e){var t=this.tokens[this.index+(e||0)];return t&&t.value},t.prototype.empty=function(){return this.tokens.length<=this.index},t.prototype.position=function(){if(this.index===this.tokens.length){var e=this.tokens[this.index-1];return e.position+e.value.length}return this.tokens[this.index].position};var n="absolute-location-path",r="additive",i="and",o="divisional",s="equality",a="filter",u="function-call",f="greater-than",p="greater-than-or-equal",h="inequality",l="less-than",c="less-than-or-equal",g="literal",w="modulus",v="multiplicative",d="negation",y="number",m="or",N="path",x="relative-location-path",E="subtractive",b="union",k="ancestor",T="ancestor-or-self",S="attribute",_="child",O="descendant-or-self",P="following-sibling",R="parent",D="preceding",U="preceding-sibling",B="self",I=[k,T,S,_,"descendant",O,"following",P,"namespace",R,D,U,B],M="comment",Y="node",A="processing-instruction",j="text",V=[M,Y,A,j];function C(e,t){t.next();var n=e.parse(t);if("]"!==t.peak())throw new Error("Invalid token at position "+t.position()+", expected closing bracket");return t.next(),n}function W(e){for(var t=0;t<V.length;t++)if(V[t]===e)return!0;return!1}function L(e,t){var n=t.peak(),r=n&&n[0];if("("===r){t.next();var i=e.parse(t);if(")"!==t.peak())throw new Error("Invalid token at position "+t.position()+", expected closing parenthesis");return t.next(),i}if('"'===r||"'"===r)return t.next(),{type:g,string:n.slice(1,-1)};if("$"===r)throw Error("Variable reference are not implemented");return/^\d+$/.test(n)||/^(\d+)?\.\d+$/.test(n)?(t.next(),{type:y,number:parseFloat(n)}):"("!==t.peak(1)||W(t.peak())?void 0:function(e,t){var n={type:u,name:t.next()};if(t.next(),")"===t.peak())t.next();else{for(n.args=[];")"!==t.peak();)n.args.push(e.parse(t)),","===t.peak()&&t.next();t.next()}return n}(e,t)}function $(e){return function(e){var t=e.peak(),n=t&&t[0];return"("===n||'"'===n||"'"===n||"$"===n||/^\d+$/.test(t)||/^(\d+)?\.\d+$/.test(t)||"("===e.peak(1)&&!W(e.peak())}(e)}function q(e,t){var n={};if("::"===t.peak(1)){if(!function(e){for(var t=0;t<I.length;t++)if(I[t]===e)return!0;return!1}(t.peak()))throw new Error("Invalid axis specifier at position "+t.position());n.axis=t.next(),t.next()}else if("@"===t.peak())t.next(),n.axis=S;else{if(".."===t.peak())return t.next(),{axis:R,test:{type:Y}};if("."===t.peak())return t.next(),{axis:B,test:{type:Y}};n.axis=_}for(n.test=function(e,t){if("*"===t.peak())return t.next(),{name:"*"};if("("===t.peak(1)){if(W(t.peak())){var n={type:t.next()};if(t.next(),n.type===A){var r=t.peak(),i=r&&r[0];'"'!==i&&"'"!==i||(n.name=t.next().slice(1,-1))}if(")"!==t.peak())throw new Error("Invalid token at position "+t.position()+", expected closing parenthesis");return t.next(),n}throw new Error("Invalid node type at position "+t.position())}return{name:t.next()}}(0,t);"["===t.peak();)n.predicates||(n.predicates=[]),n.predicates.push(C(e,t));return n}function F(e){var t=e.peak();return"string"==typeof t&&("."===t||".."===t||"@"===t||"*"===t||/^\w/.test(t))}function G(e,t){var r=t.peak();return"/"===(r&&r[0])?function(e,t){for(var r={type:n};!t.empty()&&"/"===t.peak()[0];)r.steps||(r.steps=[]),"/"===t.next()?F(t)&&r.steps.push(q(e,t)):(r.steps.push({axis:O,test:{type:Y}}),r.steps.push(q(e,t)));return r}(e,t):function(e,t){var n={type:x};for(n.steps=[q(e,t)];!t.empty()&&"/"===t.peak()[0];)"//"===t.next()&&n.steps.push({axis:O,test:{type:Y}}),n.steps.push(q(e,t));return n}(e,t)}function H(e,t){if($(t)){var n=function(e,t){var n=L(e,t);if("["===t.peak()){for(var r={type:a,primary:n,predicates:[]};"["===t.peak();)r.predicates.push(C(e,t));return r}return n}(e,t);if(t.empty()||"/"!==t.peak()[0])return n;for(var r={type:N,filter:n,steps:[]};!t.empty()&&"/"===t.peak()[0];)"//"===t.next()&&r.steps.push({axis:O,test:{type:Y}}),r.steps.push(q(e,t));return r}return G(e,t)}function z(e,t){return"-"===t.peak()?(t.next(),{type:d,lhs:z(e,t)}):function n(e,t){var r=H(e,t);if("|"===t.peak()){t.next();var i=n(e,t);return{type:b,lhs:r,rhs:i}}return r}(e,t)}function X(e,t){var n=function u(e,t){var n=z(e,t),r={"*":v,div:o,mod:w};if(r.hasOwnProperty(t.peak())){var i=t.next(),s=u(e,t);return{type:r[i],lhs:n,rhs:s}}return n}(e,t),i={"+":r,"-":E};if(i.hasOwnProperty(t.peak())){var s=t.next(),a=X(e,t);return{type:i[s],lhs:n,rhs:a}}return n}function J(e,t){var n=function a(e,t){var n=X(e,t),r={"<":l,">":f,"<=":c,">=":p};if(r.hasOwnProperty(t.peak())){var i=t.next(),o=a(e,t);return{type:r[i],lhs:n,rhs:o}}return n}(e,t),r={"=":s,"!=":h};if(r.hasOwnProperty(t.peak())){var i=t.next(),o=J(e,t);return{type:r[i],lhs:n,rhs:o}}return n}function K(e,t){var n=function o(e,t){var n=J(e,t);if("and"===t.peak()){t.next();var r=o(e,t);return{type:i,lhs:n,rhs:r}}return n}(e,t);if("or"===t.peak()){t.next();var r=K(e,t);return{type:m,lhs:n,rhs:r}}return n}function Q(e){return K({parse:Q},e)}function Z(e){this.lexer=new t(e)}function ee(e,t,n){this.node=e,this.position=t,this.last=n}Z.prototype.parse=function(){var e=Q(this.lexer);if(this.lexer.empty())return e;throw new Error("Unexpected token at position "+this.lexer.position())},ee.prototype.getNode=function(){return this.node},ee.prototype.getPosition=function(){return this.position},ee.prototype.getLast=function(){return this.last},ee.prototype.toString=function(){return"Context<"+this.node+">"};var te=3,ne=7,re=8,ie=9;function oe(e,t){this.list=e,this.reversed=t,this.current=t?e.last_:e.first_,this.lastReturned=null,this.i=0}function se(e){this.node=e}function ae(e){this.first_=null,this.last_=null,this.length_=0,e&&e.forEach(function(e){this.push(e)},this)}function ue(e,t){var n=new ae;return t.getNode().getNodeType()!==ie&&(n=(n=n.unshift(t.getNode().getParent())).merge(ue(e,new ee(t.getNode().getParent())))),n}function fe(e,t){for(var n,r=new ae,i=new ae(t.getNode().getChildNodes()).iterator();n=i.next();)r=(r=r.push(n)).merge(fe(e,new ee(n)));return r}oe.prototype.next=function(){if(this.i++,this.i>1e4)throw new Error("An error has probably ocurred!");if(this.current)return this.lastReturned=this.current,this.reversed?this.current=this.current.previous:this.current=this.current.next,this.lastReturned.node},oe.prototype.remove=function(){if(!this.lastReturned)throw new Error("remove was called before iterating!");var e=this.lastReturned.next,t=this.lastReturned.previous;e?e.previous=t:this.list.last_=t,t?t.next=e:this.list.first_=e,this.lastReturned=null,this.list.length_--},ae.prototype.iterator=function(e){return new oe(this,e)},ae.prototype.first=function(){return this.first_.node},ae.prototype.last=function(){return this.last_.node},ae.prototype.length=function(){return this.length_},ae.prototype.empty=function(){return 0===this.length()},ae.prototype.asString=function(){return this.empty()?"":this.first().asString()},ae.prototype.asNumber=function(){return+this.asString()},ae.prototype.asBoolean=function(){return 0!==this.length()},ae.prototype.merge=function(e){return ae.merge(this,e)},ae.prototype.push=function(e){var t=new se(e);return t.next=null,t.previous=this.last_,this.first_?this.last_.next=t:this.first_=t,this.last_=t,this.length_++,this},ae.prototype.unshift=function(e){var t=new se(e);return t.previous=null,t.next=this.first_,this.first_?this.first_.previous=t:this.last_=t,this.first_=t,this.length_++,this},ae.prototype.filter=function(e){for(var t,n=this.iterator();t=n.next();)e(t)||n.remove();return this},ae.merge=function(e,t){if(!e.first_)return t;if(!t.first_)return e;for(var n=e.first_,r=t.first_,i=e,o=null,s=null,a=0;n&&r;){if(n.node.isEqual(r.node))s=n,n=n.next,r=r.next;else n.node.compareDocumentPosition(r.node)>0?(s=r,r=r.next):(s=n,n=n.next);s.previous=o,o?o.next=s:i.first_=s,o=s,a++}for(s=n||r;s;)s.previous=o,o.next=s,o=s,a++,s=s.next;return i.last_=o,i.length_=a,i},ae.mergeWithoutOrder=function(e,t){for(var n,r=[],i=e.iterator();n=i.next();)r.push(n);for(i=t.iterator();n=i.next();){r.every(function(e){return!e.isEqual(n)})&&r.push(n)}return new ae(r)},ae.prototype.toString=function(){for(var e,t=this.iterator(),n=[];e=t.next();)n.push(""+e);return"NodeSet<"+n.join(", ")+">"};var pe={};function he(e){this.value=e}function le(e,t,n,r){var i,o=pe[t.axis];if(!o)throw new Error("Unknown axis specifier "+t.axis);if(i=o(e,n,r),t.test.name){var s=t.test.name;i=i.filter(function(e){return"*"===s&&e.getName()||e.getName()===t.test.name})}if(t.test.type&&t.test.type!==Y){var a;switch(t.test.type){case M:a=re;break;case A:a=ne;break;case j:a=te;break;default:throw new Error("Unknown node nodeType "+t.test.nodeType)}i=i.filter(function(e){return e.getNodeType()===a})}if(t.predicates){for(var u,f=t.axis===k||t.axis===T||t.axis===D||t.axis===U,p=0,h=[],l=i.iterator(f);u=l.next();){p++,t.predicates.every(function(t){var n=e.evaluate(t,new ee(u,p,i.length()),r);return null!==n&&(n instanceof he?n.asNumber()===p:n.asBoolean())})&&h.push(u)}i=new ae(h)}return i}function ce(e,t,n,r){var i=new ae([n.getNode()]),o=new ae;if(t.steps)for(var s=0;s<t.steps.length;s++){for(var a,u=i.iterator();a=u.next();){var f=le(e,t.steps[s],new ee(a),r);o=o.merge(f)}i=o,o=new ae}return i}function ge(e){this.value=e}function we(e){this.value=e}function ve(e,t,n,r){if(t instanceof ae&&n instanceof ae){for(var i,o=t.iterator();i=o.next();)for(var a,u=n.iterator();a=u.next();)if(r(i.asString(),a.asString()))return new ge(!0);return new ge(!1)}if(t instanceof ae||n instanceof ae){var f,p;t instanceof ae?(f=t,p=n):(f=n,p=t);for(var l,c=f.iterator();l=c.next();)if(p instanceof he){if(r(l.asNumber(),p.asNumber()))return new ge(!0)}else if(p instanceof ge){if(r(l.asBoolean(),p.asBoolean()))return new ge(!0)}else{if(!(p instanceof we))throw new Error("Unknown value type");if(r(l.asString(),p.asString()))return new ge(!0)}return new ge(!1)}if(e===s||e===h){if(t instanceof ge||n instanceof ge){if(r(t.asBoolean(),n.asBoolean()))return new ge(!0)}else if(n instanceof he||n instanceof he){if(r(t.asNumber(),n.asNumber()))return new ge(!0)}else{if(!(n instanceof we||n instanceof we))throw new Error("Unknown value types");if(r(t.asString(),n.asString()))return new ge(!0)}return new ge(!1)}return new ge(r(t.asNumber(),n.asNumber()))}pe[k]=ue,pe[T]=function(e,t){var n=new ae([t.getNode()],!0);return ue(e,t).merge(n)},pe[S]=function(e,t){return new ae(t.getNode().getAttributes())},pe[_]=function(e,t){return new ae(t.getNode().getChildNodes())},pe.descendant=fe,pe[O]=function(e,t){return new ae([t.getNode()]).merge(fe(e,t))},pe.following=function(e,t){return e.evaluate({type:x,steps:[{axis:T,test:{type:Y}},{axis:P,test:{type:Y}},{axis:O,test:{type:Y}}]},t)},pe[P]=function(e,t){return new ae(t.getNode().getFollowingSiblings())},pe.namespace=function(){throw new Error("Namespace axis is not implemented")},pe[R]=function(e,t){var n=new ae;return t.getNode().getNodeType()!==ie&&(n=n.push(t.getNode().getParent())),n},pe[D]=function(e,t){return e.evaluate({type:x,steps:[{axis:T,test:{type:Y}},{axis:U,test:{type:Y}},{axis:O,test:{type:Y}}]},t)},pe[U]=function(e,t){return new ae(t.getNode().getPrecedingSiblings())},pe[B]=function(e,t){return new ae([t.getNode()])},he.prototype.asString=function(){return""+this.value},he.prototype.asNumber=function(){return this.value},he.prototype.asBoolean=function(){return!!this.value},ge.prototype.asString=function(){return""+this.value},ge.prototype.asNumber=function(){return this.value?1:0},ge.prototype.asBoolean=function(){return this.value},we.prototype.asString=function(){return this.value},we.prototype.asNumber=function(){return+this.value},we.prototype.asBoolean=function(){return 0!==this.value.length};var de={boolean:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");return new ge(t.asBoolean())},ceiling:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof he))throw new Error("Wrong type of argument");return new he(Math.ceil(t.asNumber()))},concat:function(){var e=[].slice.call(arguments);if(e.shift(),0===e.length)throw new Error("Expected some arguments");return new we((e=e.map(function(e){return e.asString()})).join(""))},contains:function(e,t,n){if(!n)throw new Error("Expected two arguments");return t=t.asString(),n=n.asString(),new ge(-1!==t.indexOf(n))},count:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof ae))throw new Error("Wrong type of argument");return new he(t.length())},"false":function(){return new ge(!1)},floor:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof he))throw new Error("Wrong type of argument");return new he(Math.floor(t.asNumber()))},id:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");var n,r=[];if(t instanceof ae)for(var i=t.iterator();n=i.next();)r=r.concat(n.asString().split(/\s+/g));else t instanceof we?r=t.asString().split(/\s+/g):r.push(t.asString());for(var o=new ae,s=0;s<r.length;s++)(n=e.getNode().getNodeType()===ie?e.getNode().getElementById(r[s]):e.getNode().getOwnerDocument().getElementById(r[s]))&&(o=o.merge(new ae([n])));return o},last:function(e){return new he(e.getLast())},"local-name":function(e,t){if(t||(t=new ae([e.getNode()])),arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof ae))throw new Error("Wrong type of argument");return t.empty()?new we(""):new we(t.first().getName())},name:function(e,t){if(t){if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof ae))throw new Error("Wrong type of argument");return t.empty()?new we(""):new we(t.first().getName())}return new we(e.getNode().getName())},"normalize-space":function(e,t){var n;if(t){if(arguments.length>2)throw new Error("Unknown argument(s)");n=t.asString()}else n=e.getNode().asString();return new we(n.trim().replace(/\s{2,}/g," "))},not:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");return new ge(!t.asBoolean())},number:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");return new he(t.asNumber())},position:function(e){return new he(e.getPosition())},round:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof he))throw new Error("Wrong type of argument");return new he(Math.round(t.asNumber()))},"starts-with":function(e,t,n){if(!n)throw new Error("Expected two arguments");return t=t.asString(),n=n.asString(),new ge(0===t.indexOf(n))},"string-length":function(e,t){if(t){if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof we))throw new Error("Wrong type of argument");t=t.asString()}else t=e.getNode().asString();return new he(t.length)},string:function(e,t){if(t||(t=new ae([e.getNode()])),arguments.length>2)throw new Error("Unknown argument(s)");return new we(t.asString())},"substring-after":function(e,t,n){if(!n)throw new Error("Expected two arguments");t=t.asString(),n=n.asString();var r=t.indexOf(n);return new we(-1===r?"":t.substring(r+n.length))},"substring-before":function(e,t,n){if(!n)throw new Error("Expected two arguments");t=t.asString(),n=n.asString();var r=t.indexOf(n);return new we(-1===r?"":t.substring(0,r))},substring:function(e,t,n,r){if(!n)throw new Error("Expected two or three arguments");return t=t.asString(),n=Math.round(n.asNumber()),isNaN(n)||n===Infinity||n===-Infinity?new we(""):r&&(r=Math.round(r.asNumber()),isNaN(r)||r===-Infinity)?new we(""):new we(r?t.substring(n-1,n+r-1):t.substring(n-1))},sum:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof ae))throw new Error("Wrong type of argument");for(var n,r=0,i=t.iterator();n=i.next();)r+=n.asNumber();return new he(r)},translate:function(e,t,n,r){if(!r)throw new Error("Expected three arguments");if(!(t instanceof we&&n instanceof we&&r instanceof we))throw new Error("Expected string arguments");t=t.asString(),n=n.asString(),r=r.asString();for(var i=0;i<n.length;i++)t=i<r.length?t.replace(new RegExp(n[i],"g"),r[i]):t.replace(new RegExp(n[i],"g"),"");return new we(t)},"true":function(){return new ge(!0)}};var ye={};function me(e){this.expression=e}function Ne(e,t){this.code=e,this.message=t}ye[n]=function(e,t,n,r){return n.getNode().getNodeType()!==ie&&(n=new ee(n.getNode().getOwnerDocument())),ce(e,t,n,r)},ye[r]=function(e,t,n,r){var i=e.evaluate(t.lhs,n,r),o=e.evaluate(t.rhs,n,r);return new he(i.asNumber()+o.asNumber())},ye[i]=function(e,t,n,r){return e.evaluate(t.lhs,n,r).asBoolean()?e.evaluate(t.rhs,n,r):new ge(!1)},ye[o]=function(e,t,n,r){var i=e.evaluate(t.lhs,n,r),o=e.evaluate(t.rhs,n,r);return new he(i.asNumber()/o.asNumber())},ye[s]=function(e,t,n,r){return ve(t.type,e.evaluate(t.lhs,n,r),e.evaluate(t.rhs,n,r),function(e,t){return e===t})},ye[a]=function(e,t,n,r){for(var i,o=e.evaluate(t.primary,n,r),s=0,a=[],u=o.iterator();i=u.next();)s++,t.predicates.every(function(t){var n=e.evaluate(t,new ee(i,s,o.length()),r);return null!==n&&(n instanceof he?n.asNumber()===s:n.asBoolean())})&&a.push(i);return new ae(a)},ye[u]=function(e,t,n,r){var i=(t.args||[]).map(function(t){return e.evaluate(t,n,r)});i.unshift(n);var o=de[t.name];if(o)return o.apply(null,i);throw new Error("Unknown function "+t.name)},ye[f]=function(e,t,n,r){return ve(t.type,e.evaluate(t.lhs,n,r),e.evaluate(t.rhs,n,r),function(e,t){return e>t})},ye[p]=function(e,t,n,r){return ve(t.type,e.evaluate(t.lhs,n,r),e.evaluate(t.rhs,n,r),function(e,t){return e>=t})},ye[h]=function(e,t,n,r){return ve(t.type,e.evaluate(t.lhs,n,r),e.evaluate(t.rhs,n,r),function(e,t){return e!==t})},ye[l]=function(e,t,n,r){return ve(t.type,e.evaluate(t.lhs,n,r),e.evaluate(t.rhs,n,r),function(e,t){return e<t})},ye[c]=function(e,t,n,r){return ve(t.type,e.evaluate(t.lhs,n,r),e.evaluate(t.rhs,n,r),function(e,t){return e<=t})},ye[g]=function(e,t){return new we(t.string)},ye[w]=function(e,t,n,r){var i=e.evaluate(t.lhs,n,r),o=e.evaluate(t.rhs,n,r);return new he(i.asNumber()%o.asNumber())},ye[v]=function(e,t,n,r){var i=e.evaluate(t.lhs,n,r),o=e.evaluate(t.rhs,n,r);return new he(i.asNumber()*o.asNumber())},ye[d]=function(e,t,n,r){return new he(-e.evaluate(t.lhs,n,r).asNumber())},ye[y]=function(e,t){return new he(t.number)},ye[m]=function(e,t,n,r){return e.evaluate(t.lhs,n,r).asBoolean()?new ge(!0):e.evaluate(t.rhs,n,r)},ye[N]=function(e,t,n,r){var i=e.evaluate(t.filter,n,r);if(t.steps){for(var o,s=[],a=i.iterator();o=a.next();)s.push(ce(e,t,new ee(o),r));i=s.reduce(function(e,t){return e.merge(t)})}return i},ye[x]=ce,ye[E]=function(e,t,n,r){var i=e.evaluate(t.lhs,n,r),o=e.evaluate(t.rhs,n,r);return new he(i.asNumber()-o.asNumber())},ye[b]=function(e,t,n,r){var i=e.evaluate(t.lhs,n,r),o=e.evaluate(t.rhs,n,r);return i.merge(o)},me.evaluate=function(e,t,n){return(0,ye[e.type])(me,e,t,n)},me.prototype.evaluate=function(e,t,n){var r=new Z(this.expression).parse();return me.evaluate(r,new ee(new n(e)),t)};var xe=52,Ee=0,be=1,ke=2,Te=3,Se=4,_e=5,Oe=6,Pe=7,Re=8,De=9;function Ue(e,t){if(this.value=t,e===Ee)if(t instanceof ae)this.resultType=Se;else if(t instanceof we)this.resultType=ke;else if(t instanceof he)this.resultType=be;else{if(!(t instanceof ge))throw new Error("Unexpected evaluation result");this.resultType=Te}else this.resultType=e;if(this.resultType!==ke&&this.resultType!==be&&this.resultType!==Te&&!(t instanceof ae))throw Error("Value could not be converted to the specified type");if(this.resultType===Se||this.resultType===_e||this.resultType===Oe||this.resultType===Pe){this.nodes=[];for(var n,r=this.value.iterator();n=r.next();)this.nodes.push(n.getNativeNode())}var i=this,o=!0;try{Object.defineProperty({},"x",{})}catch(s){o=!1}o?(Object.defineProperty(this,"numberValue",{get:function(){if(i.resultType!==be)throw new Ne(xe,"resultType is not NUMBER_TYPE");return i.value.asNumber()}}),Object.defineProperty(this,"stringValue",{get:function(){if(i.resultType!==ke)throw new Ne(xe,"resultType is not STRING_TYPE");return i.value.asString()}}),Object.defineProperty(this,"booleanValue",{get:function(){if(i.resultType!==Te)throw new Ne(xe,"resultType is not BOOLEAN_TYPE");return i.value.asBoolean()}}),Object.defineProperty(this,"singleNodeValue",{get:function(){if(i.resultType!==De&&i.resultType!==Re)throw new Ne(xe,"resultType is not a node set");return i.value.empty()?null:i.value.first().getNativeNode()}}),Object.defineProperty(this,"invalidIteratorState",{get:function(){throw new Error("invalidIteratorState is not implemented")}}),Object.defineProperty(this,"snapshotLength",{get:function(){if(i.resultType!==Pe&&i.resultType!==Oe)throw new Ne(xe,"resultType is not a node set");return i.value.length()}})):(i.resultType===be&&(i.numberValue=i.value.asNumber()),i.resultType===ke&&(i.stringValue=i.value.asString()),i.resultType===Te&&(i.booleanValue=i.value.asBoolean()),i.resultType!==De&&i.resultType!==Re||(i.singleNodeValue=i.value.empty()?null:i.value.first().getNativeNode()),i.resultType!==Pe&&i.resultType!==Oe||(i.snapshotLength=i.value.length()))}function Be(){throw new Error("Namespaces are not implemented")}function Ie(e){this.adapter=e}Ue.prototype.iterateNext=function(){if(this.resultType!==_e&&this.resultType!==Se)throw new Ne(xe,"iterateNext called with wrong result type");return this.index=this.index||0,this.index>=this.nodes.length?null:this.nodes[this.index++]},Ue.prototype.snapshotItem=function(e){if(this.resultType!==Pe&&this.resultType!==Oe)throw new Ne(xe,"snapshotItem called with wrong result type");return this.nodes[e]||null},Ue.ANY_TYPE=Ee,Ue.NUMBER_TYPE=be,Ue.STRING_TYPE=ke,Ue.BOOLEAN_TYPE=Te,Ue.UNORDERED_NODE_ITERATOR_TYPE=Se,Ue.ORDERED_NODE_ITERATOR_TYPE=_e,Ue.UNORDERED_NODE_SNAPSHOT_TYPE=Oe,Ue.ORDERED_NODE_SNAPSHOT_TYPE=Pe,Ue.ANY_UNORDERED_NODE_TYPE=Re,Ue.FIRST_ORDERED_NODE_TYPE=De,Ie.prototype.evaluate=function(e,t,n,r){return n&&Be(),new Ue(r,this.createExpression(e).evaluate(t,r,this.adapter))},Ie.prototype.createExpression=function(e,t){return t&&Be(),new me(e)},Ie.prototype.createNSResolver=function(){Be()};var Me=2,Ye=4;function Ae(e){if(!e)throw new Error("This should not happen!");this.nativeNode=e}Ae.prototype.getNativeNode=function(){return this.nativeNode},Ae.prototype.asString=function(){if("string"==typeof this.nativeNode.textContent)return this.nativeNode.textContent;for(var e="",t=this.getChildNodes(),n=0;n<t.length;n++)e+=t[n].asString();return e},Ae.prototype.asNumber=function(){return+this.asString()},Ae.prototype.getNodeType=function(){return this.nativeNode.nodeType},Ae.prototype.getChildNodes=function(){for(var e=[],t=0;t<this.nativeNode.childNodes.length;t++)e.push(new Ae(this.nativeNode.childNodes[t]));return e},Ae.prototype.getFollowingSiblings=function(){for(var e=this.nativeNode,t=[];e=e.nextSibling;)t.push(new Ae(e));return t},Ae.prototype.getPrecedingSiblings=function(){for(var e=this.nativeNode,t=[];e=e.previousSibling;)t.unshift(new Ae(e));return t},Ae.prototype.getName=function(){var e=this.nativeNode.tagName||this.nativeNode.name;if(e)return e.toLowerCase()},Ae.prototype.getAttributes=function(){if(!this.nativeNode.attributes)return[];for(var e=[],t=0;t<this.nativeNode.attributes.length;t++)e.push(new Ae(this.nativeNode.attributes[t]));return e},Ae.prototype.getParent=function(){return new Ae(this.nativeNode.parentNode||this.nativeNode.ownerElement)},Ae.prototype.getOwnerDocument=function(){if(this.nativeNode.ownerDocument)return new Ae(this.nativeNode.ownerDocument)},Ae.prototype.getElementById=function(e){var t=this.nativeNode.getElementById(e);if(t)return new Ae(t)},Ae.prototype.isEqual=function(e){return this.getNativeNode()===e.getNativeNode()},Ae.prototype.compareDocumentPosition=function(e){var t=this;t.getNativeNode()instanceof Attr&&(t=t.getParent()),e.getNativeNode()instanceof Attr&&(e=e.getParent());var n=t.getNativeNode().compareDocumentPosition(e.getNativeNode());return n&Me?1:n&Ye?-1:0},Ae.prototype.toString=function(){var e;return e=this.nativeNode.tagName?this.nativeNode.tagName.toLowerCase():this.nativeNode.nodeName+"("+this.nativeNode.nodeValue+")",this.nativeNode.className&&(e=e+"."+this.nativeNode.className.split(/\s+/g).join(".")),this.nativeNode.id&&(e=e+"#"+this.nativeNode.id),"Node<"+e+">"};var je=new Ie(Ae),Ve=je.evaluate.bind(je),Ce=je.createExpression.bind(je),We=je.createNSResolver.bind(je);window.document.evaluate||(window.document.evaluate=Ve,window.document.createExpression=Ce,window.document.createNSResolver=We,window.XPathResult=Ue)}();
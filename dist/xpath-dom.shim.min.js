!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.xpathDom=e()}}(function(){return function e(t,r,n){function s(o,a){if(!r[o]){if(!t[o]){var p="function"==typeof require&&require;if(!a&&p)return p(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[o]={exports:{}};t[o][0].call(l.exports,function(e){var r=t[o][1][e];return s(r?r:e)},l,l.exports,e,t,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(e){if(!window.document.evaluate){var t=e("./register");window.document.evaluate=t.evaluate,window.document.createExpression=t.createExpression,window.document.createNSResolver=t.createNSResolver,window.XPathResult=t.XPathResult;var r;for(r in t.XPathResultType)t.XPathResultType.hasOwnProperty(r)&&(window.XPathResult[r]=t.XPathResultType[r])}},{"./register":106}],2:[function(e,t){"use strict";function r(e){if(!e)throw new Error("This should not happen!");this.nativeNode=e}var n={DISCONNECTED:1,PRECEDING:2,FOLLOWING:4,CONTAINS:8,CONTAINED_BY:16,IMPLEMENTATION_SPECIFIC:32};r.prototype.getNativeNode=function(){return this.nativeNode},r.prototype.asString=function(){if("string"==typeof this.nativeNode.textContent)return this.nativeNode.textContent;for(var e="",t=this.getChildNodes(),r=0;r<t.length;r++)e+=t[r].asString();return e},r.prototype.asNumber=function(){return+this.asString()},r.prototype.getNodeType=function(){return this.nativeNode.nodeType},r.prototype.getChildNodes=function(){for(var e=[],t=0;t<this.nativeNode.childNodes.length;t++)e.push(new r(this.nativeNode.childNodes[t]));return e},r.prototype.getFollowingSiblings=function(){for(var e=this.nativeNode,t=[];e=e.nextSibling;)t.push(new r(e));return t},r.prototype.getPrecedingSiblings=function(){for(var e=this.nativeNode,t=[];e=e.previousSibling;)t.unshift(new r(e));return t},r.prototype.getName=function(){var e=this.nativeNode.tagName||this.nativeNode.name;return e?e.toLowerCase():void 0},r.prototype.getAttributes=function(){if(!this.nativeNode.attributes)return[];for(var e=[],t=0;t<this.nativeNode.attributes.length;t++)e.push(new r(this.nativeNode.attributes[t]));return e},r.prototype.getParent=function(){return new r(this.nativeNode.parentNode||this.nativeNode.ownerElement)},r.prototype.getOwnerDocument=function(){return this.nativeNode.ownerDocument?new r(this.nativeNode.ownerDocument):this},r.prototype.getElementById=function(e){var t=this.nativeNode.getElementById(e);return t?new r(t):void 0},r.compareDocumentPosition=function(e,t){return e.getNativeNode().compareDocumentPosition(t.getNativeNode())&n.PRECEDING?1:e.getNativeNode().compareDocumentPosition(t.getNativeNode())&n.FOLLOWING?-1:0},r.prototype.toString=function(){var e;return e=this.nativeNode.tagName?this.nativeNode.tagName.toLowerCase():this.nativeNode.nodeName+"("+this.nativeNode.nodeValue+")",this.nativeNode.className&&(e=e+"."+this.nativeNode.className.split(/\s+/g).join(".")),this.nativeNode.id&&(e=e+"#"+this.nativeNode.id),"Node<"+e+">"},t.exports=r},{}],3:[function(e,t){"use strict";t.exports={ANCESTOR:"ancestor",ANCESTOR_OR_SELF:"ancestor-or-self",ATTRIBUTE:"attribute",CHILD:"child",DESCENDANT:"descendant",DESCENDANT_OR_SELF:"descendant-or-self",FOLLOWING:"following",FOLLOWING_SIBLING:"following-sibling",NAMESPACE:"namespace",PARENT:"parent",PRECEDING:"preceding",PRECEDING_SIBLING:"preceding-sibling",SELF:"self",isValidAxisSpecifier:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]===e)return!0;return!1}}},{}],4:[function(e,t){t.exports={ABSOLUTE_LOCATION_PATH:"absolute-location-path",ADDITIVE:"additive",AND:"and",DIVISIONAL:"divisional",EQUALITY:"equality",FILTER:"filter",FUNCTION_CALL:"function-call",GREATER_THAN:"greater-than",GREATER_THAN_OR_EQUAL:"greater-than-or-equal",INEQUALITY:"inequality",LESS_THAN:"less-than",LESS_THAN_OR_EQUAL:"less-than-or-equal",LITERAL:"literal",MODULUS:"modulus",MULTIPLICATIVE:"multiplicative",NEGATION:"negation",NUMBER:"number",OR:"or",PATH:"path",RELATIVE_LOCATION_PATH:"relative-location-path",SUBTRACTIVE:"subtractive",UNION:"union"}},{}],5:[function(e,t){"use strict";t.exports={COMMENT:"comment",NODE:"node",PROCESSING_INSTRUCTION:"processing-instruction",TEXT:"text",isValidNodeType:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]===e)return!0;return!1}}},{}],6:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../axis_specifier"),s=e("../expr_type"),i=e("../node_type"),o=e("./step");r.prototype.parse=function(){for(var e={type:s.ABSOLUTE_LOCATION_PATH};!this.lexer.empty()&&"/"===this.lexer.peak()[0];)if(e.steps||(e.steps=[]),"/"===this.lexer.next()){var t=this.lexer.peak();this.lexer.empty()||"."!==t&&".."!==t&&"@"!==t&&"*"!==t&&!/(?![0-9])[\w]/.test(t)||e.steps.push(new o(this.lexer).parse())}else e.steps.push({axis:n.DESCENDANT_OR_SELF,test:{type:i.NODE}}),e.steps.push(new o(this.lexer).parse());return e}},{"../axis_specifier":3,"../expr_type":4,"../node_type":5,"./step":22}],7:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../expr_type"),s=e("./multiplicative_expr");r.prototype.parse=function(){var e=new s(this.lexer).parse(),t={"+":n.ADDITIVE,"-":n.SUBTRACTIVE};if(t.hasOwnProperty(this.lexer.peak())){var i=this.lexer.next(),o=new r(this.lexer).parse();return{type:t[i],lhs:e,rhs:o}}return e}},{"../expr_type":4,"./multiplicative_expr":14}],8:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../expr_type"),s=e("./equality_expr");r.prototype.parse=function(){var e=new s(this.lexer).parse();if("and"===this.lexer.peak()){this.lexer.next();var t=new r(this.lexer).parse();return{type:n.AND,lhs:e,rhs:t}}return e}},{"../expr_type":4,"./equality_expr":9}],9:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../expr_type"),s=e("./relational_expr");r.prototype.parse=function(){var e=new s(this.lexer).parse(),t={"=":n.EQUALITY,"!=":n.INEQUALITY};if(t.hasOwnProperty(this.lexer.peak())){var i=this.lexer.next(),o=new r(this.lexer).parse();return{type:t[i],lhs:e,rhs:o}}return e}},{"../expr_type":4,"./relational_expr":20}],10:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("./or_expr");r.prototype.parse=function(){return new n(this.lexer).parse()}},{"./or_expr":16}],11:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../expr_type"),s=e("./predicate"),i=e("./primary_expr");r.prototype.parse=function(){var e=new i(this.lexer).parse();if("["===this.lexer.peak()){for(var t={type:n.FILTER,primary:e,predicates:[]};"["===this.lexer.peak();)t.predicates.push(new s(this.lexer).parse());return t}return e},r.isValidOp=function(e){return i.isValidOp(e)}},{"../expr_type":4,"./predicate":18,"./primary_expr":19}],12:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../expr_type"),s=e("./expr");r.prototype.parse=function(){var e={type:n.FUNCTION_CALL,name:this.lexer.next()};if(this.lexer.next(),")"===this.lexer.peak())this.lexer.next();else{for(e.args=[];")"!==this.lexer.peak();)e.args.push(new s(this.lexer).parse()),","===this.lexer.peak()&&this.lexer.next();this.lexer.next()}return e}},{"../expr_type":4,"./expr":10}],13:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("./absolute_location_path"),s=e("./relative_location_path");r.prototype.parse=function(){var e=this.lexer.peak()[0];return"/"===e?new n(this.lexer).parse():new s(this.lexer).parse()}},{"./absolute_location_path":6,"./relative_location_path":21}],14:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../expr_type"),s=e("./unary_expr");r.prototype.parse=function(){var e=new s(this.lexer).parse(),t={"*":n.MULTIPLICATIVE,div:n.DIVISIONAL,mod:n.MODULUS};if(t.hasOwnProperty(this.lexer.peak())){var i=this.lexer.next(),o=new r(this.lexer).parse();return{type:t[i],lhs:e,rhs:o}}return e}},{"../expr_type":4,"./unary_expr":23}],15:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../node_type");r.prototype.parse=function(){if("*"===this.lexer.peak())return this.lexer.next(),{name:"*"};if("("===this.lexer.peak(1)){if(n.isValidNodeType(this.lexer.peak())){var e={type:this.lexer.next()};return this.lexer.next(),")"===this.lexer.peak()?this.lexer.next():(e.name=this.lexer.next(),this.lexer.next()),e}throw new Error("Unexpected token "+this.lexer.peak())}return{name:this.lexer.next()}}},{"../node_type":5}],16:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../expr_type"),s=e("./and_expr");r.prototype.parse=function(){var e=new s(this.lexer).parse();if("or"===this.lexer.peak()){this.lexer.next();var t=new r(this.lexer).parse();return{type:n.OR,lhs:e,rhs:t}}return e}},{"../expr_type":4,"./and_expr":8}],17:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../axis_specifier"),s=e("../expr_type"),i=e("../node_type"),o=e("./filter_expr"),a=e("./location_path"),p=e("./step");r.prototype.parse=function(){if(o.isValidOp(this.lexer)){var e=new o(this.lexer).parse();if(this.lexer.empty()||"/"!==this.lexer.peak()[0])return e;for(var t={type:s.PATH,filter:e,steps:[]};!this.lexer.empty()&&"/"===this.lexer.peak()[0];)"//"===this.lexer.next()&&t.steps.push({axis:n.DESCENDANT_OR_SELF,test:{type:i.NODE}}),t.steps.push(new p(this.lexer).parse());return t}return new a(this.lexer).parse()}},{"../axis_specifier":3,"../expr_type":4,"../node_type":5,"./filter_expr":11,"./location_path":13,"./step":22}],18:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("./expr");r.prototype.parse=function(){this.lexer.next();var e=new n(this.lexer).parse();if("]"!==this.lexer.next())throw new Error("Unclosed brackets");return e}},{"./expr":10}],19:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../expr_type"),s=e("../node_type"),i=e("./expr"),o=e("./function_call");r.prototype.parse=function(){var e=this.lexer.peak(),t=e[0];if("("===t){this.lexer.next();var r=new i(this.lexer).parse();if(")"!==this.lexer.next())throw new Error("Unclosed parentheses");return r}if('"'===t||"'"===t)return this.lexer.next(),{type:n.LITERAL,string:e.slice(1,-1)};if("$"===t)throw Error("Variable reference are not implemented");return/^\d+$/.test(e)||/^(\d+)?\.\d+$/.test(e)?(this.lexer.next(),{type:n.NUMBER,number:parseFloat(e)}):"("!==this.lexer.peak(1)||s.isValidNodeType(this.lexer.peak())?void 0:new o(this.lexer).parse()},r.isValidOp=function(e){var t=e.peak(),r=t[0];return"("===r||'"'===r||"'"===r||"$"===r||/^\d+$/.test(t)||/^(\d+)?\.\d+$/.test(t)||"("===e.peak(1)&&!s.isValidNodeType(e.peak())}},{"../expr_type":4,"../node_type":5,"./expr":10,"./function_call":12}],20:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../expr_type"),s=e("./additive_expr");r.prototype.parse=function(){var e=new s(this.lexer).parse(),t={"<":n.LESS_THAN,">":n.GREATER_THAN,"<=":n.LESS_THAN_OR_EQUAL,">=":n.GREATER_THAN_OR_EQUAL};if(t.hasOwnProperty(this.lexer.peak())){var i=this.lexer.next(),o=new r(this.lexer).parse();return{type:t[i],lhs:e,rhs:o}}return e}},{"../expr_type":4,"./additive_expr":7}],21:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../axis_specifier"),s=e("../expr_type"),i=e("../node_type"),o=e("./step");r.prototype.parse=function(){var e={type:s.RELATIVE_LOCATION_PATH};for(e.steps=[new o(this.lexer).parse()];!this.lexer.empty()&&"/"===this.lexer.peak()[0];)"/"===this.lexer.next()?e.steps.push(new o(this.lexer).parse()):(e.steps.push({axis:n.DESCENDANT_OR_SELF,test:{type:i.NODE}}),e.steps.push(new o(this.lexer).parse()));return e}},{"../axis_specifier":3,"../expr_type":4,"../node_type":5,"./step":22}],22:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../axis_specifier"),s=e("../node_type"),i=e("./node_test"),o=e("./predicate");r.prototype.parse=function(){var e={};if("::"===this.lexer.peak(1)){var t=this.lexer.next();if(this.lexer.next(),!n.isValidAxisSpecifier(t))throw new Error("Unexpected token "+t);e.axis=t}else if("@"===this.lexer.peak())this.lexer.next(),e.axis=n.ATTRIBUTE;else{if(".."===this.lexer.peak())return this.lexer.next(),{axis:n.PARENT,test:{type:s.NODE}};if("."===this.lexer.peak())return this.lexer.next(),{axis:n.SELF,test:{type:s.NODE}};e.axis=n.CHILD}for(e.test=new i(this.lexer).parse();"["===this.lexer.peak();)e.predicates||(e.predicates=[]),e.predicates.push(new o(this.lexer).parse());return e}},{"../axis_specifier":3,"../node_type":5,"./node_test":15,"./predicate":18}],23:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../expr_type"),s=e("./union_expr");r.prototype.parse=function(){return"-"===this.lexer.peak()?(this.lexer.next(),{type:n.NEGATION,lhs:new r(this.lexer).parse()}):new s(this.lexer).parse()}},{"../expr_type":4,"./union_expr":24}],24:[function(e,t){"use strict";function r(e){this.lexer=e}t.exports=r;var n=e("../expr_type"),s=e("./path_expr");r.prototype.parse=function(){var e=new s(this.lexer).parse();if("|"===this.lexer.peak()){this.lexer.next();var t=new r(this.lexer).parse();return{type:n.UNION,lhs:e,rhs:t}}return e}},{"../expr_type":4,"./path_expr":17}],25:[function(e,t){"use strict";function r(e){this.lexer=new n(e)}var n=e("xpath-lexer"),s=e("./axis_specifier"),i=e("./expr_type"),o=e("./node_type"),a=e("./parsers/expr");r.AxisSpecifier=s,r.ExprType=i,r.NodeType=o,r.prototype.parse=function(){var e=new a(this.lexer).parse();if(this.lexer.empty())return e;throw new Error("Unexpected token "+this.lexer.peak())},t.exports=r},{"./axis_specifier":3,"./expr_type":4,"./node_type":5,"./parsers/expr":10,"xpath-lexer":105}],26:[function(e,t){"use strict";t.exports={setAdapter:function(e){this.adapter=e},getAdapter:function(){if(!this.adapter)throw new Error("No adapter is specified");return this.adapter}}},{}],27:[function(e,t){t.exports={};var r=e("xpath-analyzer"),n=e("./axes/ancestor"),s=e("./axes/ancestor_or_self"),i=e("./axes/attribute"),o=e("./axes/child"),a=e("./axes/descendant"),p=e("./axes/descendant_or_self"),u=e("./axes/following"),l=e("./axes/following_sibling"),c=e("./axes/namespace"),f=e("./axes/parent"),x=e("./axes/preceding"),h=e("./axes/preceding_sibling"),_=e("./axes/self");t.exports[r.AxisSpecifier.ANCESTOR]=n,t.exports[r.AxisSpecifier.ANCESTOR_OR_SELF]=s,t.exports[r.AxisSpecifier.ATTRIBUTE]=i,t.exports[r.AxisSpecifier.CHILD]=o,t.exports[r.AxisSpecifier.DESCENDANT]=a,t.exports[r.AxisSpecifier.DESCENDANT_OR_SELF]=p,t.exports[r.AxisSpecifier.FOLLOWING]=u,t.exports[r.AxisSpecifier.FOLLOWING_SIBLING]=l,t.exports[r.AxisSpecifier.NAMESPACE]=c,t.exports[r.AxisSpecifier.PARENT]=f,t.exports[r.AxisSpecifier.PRECEDING]=x,t.exports[r.AxisSpecifier.PRECEDING_SIBLING]=h,t.exports[r.AxisSpecifier.SELF]=_},{"./axes/ancestor":28,"./axes/ancestor_or_self":29,"./axes/attribute":30,"./axes/child":31,"./axes/descendant":32,"./axes/descendant_or_self":33,"./axes/following":34,"./axes/following_sibling":35,"./axes/namespace":36,"./axes/parent":37,"./axes/preceding":38,"./axes/preceding_sibling":39,"./axes/self":40,"xpath-analyzer":25}],28:[function(e,t){"use strict";var r=e("../context"),n=e("../node"),s=e("../types/node_set_type");t.exports={evaluate:function(e){var t=new s;return e.getNode().getNodeType()!==n.DOCUMENT_NODE&&(t=t.unshift(e.getNode().getParent()),t=t.merge(this.evaluate(new r(e.getNode().getParent())))),t}}},{"../context":41,"../node":94,"../types/node_set_type":96}],29:[function(e,t){"use strict";var r=e("../types/node_set_type"),n=e("./ancestor");t.exports={evaluate:function(e){var t=new r([e.getNode()],!0);return n.evaluate(e).merge(t)}}},{"../types/node_set_type":96,"./ancestor":28}],30:[function(e,t){"use strict";var r=e("../types/node_set_type");t.exports={evaluate:function(e){return new r(e.getNode().getAttributes())}}},{"../types/node_set_type":96}],31:[function(e,t){"use strict";var r=e("../types/node_set_type");t.exports={evaluate:function(e){return new r(e.getNode().getChildNodes())}}},{"../types/node_set_type":96}],32:[function(e,t){"use strict";var r=e("../context"),n=e("../types/node_set_type");t.exports={evaluate:function(e){for(var t,s=new n,i=new n(e.getNode().getChildNodes()),o=i.iterator();t=o.next();)s=s.push(t),s=s.merge(this.evaluate(new r(t)));return s}}},{"../context":41,"../types/node_set_type":96}],33:[function(e,t){"use strict";var r=e("../types/node_set_type"),n=e("./descendant");t.exports={evaluate:function(e){var t=new r([e.getNode()]);return t.merge(n.evaluate(e))}}},{"../types/node_set_type":96,"./descendant":32}],34:[function(e,t){"use strict";var r=e("xpath-analyzer"),n=e("../evaluators/relative_location_path");t.exports={evaluate:function(e){return n.evaluate({steps:[{axis:r.AxisSpecifier.ANCESTOR_OR_SELF,test:{type:r.NodeType.NODE}},{axis:r.AxisSpecifier.FOLLOWING_SIBLING,test:{type:r.NodeType.NODE}},{axis:r.AxisSpecifier.DESCENDANT_OR_SELF,test:{type:r.NodeType.NODE}}]},e)}}},{"../evaluators/relative_location_path":63,"xpath-analyzer":25}],35:[function(e,t){"use strict";var r=e("../types/node_set_type");t.exports={evaluate:function(e){return new r(e.getNode().getFollowingSiblings())}}},{"../types/node_set_type":96}],36:[function(){},{}],37:[function(e,t){"use strict";var r=e("../node"),n=e("../types/node_set_type");t.exports={evaluate:function(e){var t=new n;return e.getNode().getNodeType()!==r.DOCUMENT_NODE&&(t=t.push(e.getNode().getParent())),t}}},{"../node":94,"../types/node_set_type":96}],38:[function(e,t){"use strict";var r=e("xpath-analyzer"),n=e("../evaluators/relative_location_path");t.exports={evaluate:function(e){return n.evaluate({steps:[{axis:r.AxisSpecifier.ANCESTOR_OR_SELF,test:{type:r.NodeType.NODE}},{axis:r.AxisSpecifier.PRECEDING_SIBLING,test:{type:r.NodeType.NODE}},{axis:r.AxisSpecifier.DESCENDANT_OR_SELF,test:{type:r.NodeType.NODE}}]},e)}}},{"../evaluators/relative_location_path":63,"xpath-analyzer":25}],39:[function(e,t){"use strict";var r=e("../types/node_set_type");t.exports={evaluate:function(e){return new r(e.getNode().getPrecedingSiblings())}}},{"../types/node_set_type":96}],40:[function(e,t){"use strict";var r=e("../types/node_set_type");t.exports={evaluate:function(e){return new r([e.getNode()])}}},{"../types/node_set_type":96}],41:[function(e,t){"use strict";function r(e,t,r){this.node=e,this.position=t,this.last=r}r.prototype.getNode=function(){return this.node},r.prototype.getPosition=function(){return this.position},r.prototype.getLast=function(){return this.last},r.prototype.toString=function(){return"Context<"+this.node+">"},t.exports=r},{}],42:[function(e,t){t.exports={};var r=e("xpath-analyzer"),n=e("./evaluators/absolute_location_path"),s=e("./evaluators/additive"),i=e("./evaluators/and"),o=e("./evaluators/divisional"),a=e("./evaluators/equality"),p=e("./evaluators/filter"),u=e("./evaluators/function_call"),l=e("./evaluators/greater_than"),c=e("./evaluators/greater_than_or_equal"),f=e("./evaluators/inequality"),x=e("./evaluators/less_than"),h=e("./evaluators/less_than_or_equal"),_=e("./evaluators/literal"),y=e("./evaluators/modulus"),v=e("./evaluators/multiplicative"),E=e("./evaluators/negation"),N=e("./evaluators/number"),d=e("./evaluators/or"),g=e("./evaluators/path"),w=e("./evaluators/relative_location_path"),T=e("./evaluators/subtractive"),m=e("./evaluators/union");t.exports[r.ExprType.ABSOLUTE_LOCATION_PATH]=n,t.exports[r.ExprType.ADDITIVE]=s,t.exports[r.ExprType.AND]=i,t.exports[r.ExprType.DIVISIONAL]=o,t.exports[r.ExprType.EQUALITY]=a,t.exports[r.ExprType.FILTER]=p,t.exports[r.ExprType.FUNCTION_CALL]=u,t.exports[r.ExprType.GREATER_THAN]=l,t.exports[r.ExprType.GREATER_THAN_OR_EQUAL]=c,t.exports[r.ExprType.INEQUALITY]=f,t.exports[r.ExprType.LESS_THAN]=x,t.exports[r.ExprType.LESS_THAN_OR_EQUAL]=h,t.exports[r.ExprType.LITERAL]=_,t.exports[r.ExprType.MODULUS]=y,t.exports[r.ExprType.MULTIPLICATIVE]=v,t.exports[r.ExprType.NEGATION]=E,t.exports[r.ExprType.NUMBER]=N,t.exports[r.ExprType.OR]=d,t.exports[r.ExprType.PATH]=g,t.exports[r.ExprType.RELATIVE_LOCATION_PATH]=w,t.exports[r.ExprType.SUBTRACTIVE]=T,t.exports[r.ExprType.UNION]=m},{"./evaluators/absolute_location_path":43,"./evaluators/additive":44,"./evaluators/and":45,"./evaluators/divisional":46,"./evaluators/equality":47,"./evaluators/filter":48,"./evaluators/function_call":49,"./evaluators/greater_than":50,"./evaluators/greater_than_or_equal":51,"./evaluators/inequality":53,"./evaluators/less_than":54,"./evaluators/less_than_or_equal":55,"./evaluators/literal":56,"./evaluators/modulus":57,"./evaluators/multiplicative":58,"./evaluators/negation":59,"./evaluators/number":60,"./evaluators/or":61,"./evaluators/path":62,"./evaluators/relative_location_path":63,"./evaluators/subtractive":65,"./evaluators/union":66,"xpath-analyzer":25}],43:[function(e,t){"use strict";var r=e("../context"),n=e("../node"),s=e("./relative_location_path");t.exports={evaluate:function(e,t,i){return t.getNode().getNodeType()!==n.DOCUMENT_NODE&&(t=new r(t.getNode().getOwnerDocument())),s.evaluate(e,t,i)}}},{"../context":41,"../node":94,"./relative_location_path":63}],44:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("../types/number_type");t.exports={evaluate:function(e,t,s){var i=r.evaluate(e.lhs,t,s),o=r.evaluate(e.rhs,t,s);return new n(i.asNumber()+o.asNumber())}}},{"../types/number_type":97,"../xpath_expression":102}],45:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("../types/boolean_type");t.exports={evaluate:function(e,t,s){var i=r.evaluate(e.lhs,t,s);return i.asBoolean()?r.evaluate(e.rhs,t,s):new n(!1)}}},{"../types/boolean_type":95,"../xpath_expression":102}],46:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("../types/number_type");t.exports={evaluate:function(e,t,s){var i=r.evaluate(e.lhs,t,s),o=r.evaluate(e.rhs,t,s);return new n(i.asNumber()/o.asNumber())}}},{"../types/number_type":97,"../xpath_expression":102}],47:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("./helper");t.exports={evaluate:function(e,t,s){return n.compareNodes(e.type,r.evaluate(e.lhs,t,s),r.evaluate(e.rhs,t,s),function(e,t){return e===t})}}},{"../xpath_expression":102,"./helper":52}],48:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("../context"),s=e("../types/number_type"),i=e("../types/node_set_type");t.exports={evaluate:function(e,t,o){for(var a,p=r.evaluate(e.primary,t,o),u=0,l=[],c=p.iterator();a=c.next();){u++;var f=e.predicates.every(function(e){var t=r.evaluate(e,new n(a,u,p.length()),o);return null===t?!1:t instanceof s?t.asNumber()===u:t.asBoolean()});f&&l.push(a)}return new i(l)}}},{"../context":41,"../types/node_set_type":96,"../types/number_type":97,"../xpath_expression":102}],49:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("../functions");t.exports={evaluate:function(e,t,s){var i=(e.args||[]).map(function(e){return r.evaluate(e,t,s)});i.unshift(t);var o=n[e.name];if(o)return o.evaluate.apply(null,i);throw new Error("Unknown function "+e.name)}}},{"../functions":67,"../xpath_expression":102}],50:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("./helper");t.exports={evaluate:function(e,t,s){return n.compareNodes(e.type,r.evaluate(e.lhs,t,s),r.evaluate(e.rhs,t,s),function(e,t){return e>t})}}},{"../xpath_expression":102,"./helper":52}],51:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("./helper");t.exports={evaluate:function(e,t,s){return n.compareNodes(e.type,r.evaluate(e.lhs,t,s),r.evaluate(e.rhs,t,s),function(e,t){return e>=t})}}},{"../xpath_expression":102,"./helper":52}],52:[function(e,t){"use strict";var r=e("xpath-analyzer"),n=e("../types/boolean_type"),s=e("../types/node_set_type"),i=e("../types/number_type"),o=e("../types/string_type");t.exports={compareNodes:function(e,t,a,p){if(t instanceof s&&a instanceof s){for(var u,l=t.iterator();u=l.next();)for(var c,f=a.iterator();c=f.next();)if(p(u.asString(),c.asString()))return new n(!0);return new n(!1)}if(t instanceof s||a instanceof s){var x,h;t instanceof s?(x=t,h=a):(x=a,h=t);for(var _,y=x.iterator();_=y.next();)if(h instanceof i){if(p(_.asNumber(),h.asNumber()))return new n(!0)}else if(h instanceof n){if(p(_.asBoolean(),h.asBoolean()))return new n(!0)}else{if(!(h instanceof o))throw new Error("Unknown value type");if(p(_.asString(),h.asString()))return new n(!0)}return new n(!1)}if(e===r.ExprType.EQUALITY||e===r.ExprType.INEQUALITY){if(t instanceof n||a instanceof n){if(p(t.asBoolean(),a.asBoolean()))return new n(!0)}else if(a instanceof i||a instanceof i){if(p(t.asNumber(),a.asNumber()))return new n(!0)}else{if(!(a instanceof o||a instanceof o))throw new Error("Unknown value types");if(p(t.asString(),a.asString()))return new n(!0)}return new n(!1)}return new n(p(t.asNumber(),a.asNumber()))}}},{"../types/boolean_type":95,"../types/node_set_type":96,"../types/number_type":97,"../types/string_type":98,"xpath-analyzer":25}],53:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("./helper");t.exports={evaluate:function(e,t,s){return n.compareNodes(e.type,r.evaluate(e.lhs,t,s),r.evaluate(e.rhs,t,s),function(e,t){return e!==t})}}},{"../xpath_expression":102,"./helper":52}],54:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("./helper");t.exports={evaluate:function(e,t,s){return n.compareNodes(e.type,r.evaluate(e.lhs,t,s),r.evaluate(e.rhs,t,s),function(e,t){return t>e})}}},{"../xpath_expression":102,"./helper":52}],55:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("./helper");t.exports={evaluate:function(e,t,s){return n.compareNodes(e.type,r.evaluate(e.lhs,t,s),r.evaluate(e.rhs,t,s),function(e,t){return t>=e})}}},{"../xpath_expression":102,"./helper":52}],56:[function(e,t){"use strict";var r=e("../types/string_type");t.exports={evaluate:function(e){return new r(e.string)}}},{"../types/string_type":98}],57:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("../types/number_type");t.exports={evaluate:function(e,t,s){var i=r.evaluate(e.lhs,t,s),o=r.evaluate(e.rhs,t,s);return new n(i.asNumber()%o.asNumber())}}},{"../types/number_type":97,"../xpath_expression":102}],58:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("../types/number_type");t.exports={evaluate:function(e,t,s){var i=r.evaluate(e.lhs,t,s),o=r.evaluate(e.rhs,t,s);return new n(i.asNumber()*o.asNumber())}}},{"../types/number_type":97,"../xpath_expression":102}],59:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("../types/number_type");t.exports={evaluate:function(e,t,s){var i=r.evaluate(e.lhs,t,s);return new n(-i.asNumber())}}},{"../types/number_type":97,"../xpath_expression":102}],60:[function(e,t){"use strict";var r=e("../types/number_type");t.exports={evaluate:function(e){return new r(e.number)}}},{"../types/number_type":97}],61:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("../types/boolean_type");t.exports={evaluate:function(e,t,s){var i=r.evaluate(e.lhs,t,s);return i.asBoolean()?new n(!0):r.evaluate(e.rhs,t,s)}}},{"../types/boolean_type":95,"../xpath_expression":102}],62:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("../context"),s=e("./relative_location_path");t.exports={evaluate:function(e,t,i){var o=r.evaluate(e.filter,t,i);if(e.steps){for(var a,p=[],u=o.iterator();a=u.next();)p.push(s.evaluate(e,new n(a),i));o=p.reduce(function(e,t){return e.merge(t)})}return o}}},{"../context":41,"../xpath_expression":102,"./relative_location_path":63}],63:[function(e,t){"use strict";t.exports={};var r=e("../context"),n=e("../types/node_set_type"),s=e("./step");t.exports.evaluate=function(e,t,i){var o=new n([t.getNode()]),a=new n;if(e.steps)for(var p=0;p<e.steps.length;p++){for(var u,l=o.iterator();u=l.next();){var c=s.evaluate(e.steps[p],new r(u),i);a=a.merge(c)}o=a,a=new n}return o}},{"../context":41,"../types/node_set_type":96,"./step":64}],64:[function(e,t){"use strict";var r=e("xpath-analyzer"),n=e("../xpath_expression"),s=e("../axes"),i=e("../context"),o=e("../types/number_type"),a=e("../types/node_set_type"),p=e("../node");t.exports={evaluate:function(e,t,u){var l,c=s[e.axis];if(!c)throw new Error("Unknown axis specifier "+e.axis);if(l=c.evaluate(t,u),e.test.name){var f=e.test.name;l=l.filter(function(t){return"*"===f&&t.getName()||t.getName()===e.test.name})}if(e.test.type&&e.test.type!==r.NodeType.NODE){var x;switch(e.test.type){case r.NodeType.COMMENT:x=p.COMMENT_NODE;break;case r.NodeType.PROCESSING_INSTRUCTION:x=p.PROCESSING_INSTRUCTION_NODE;break;case r.NodeType.TEXT:x=p.TEXT_NODE;break;default:throw new Error("Unknown node nodeType "+e.test.nodeType)}l=l.filter(function(e){return e.getNodeType()===x})}if(e.predicates){for(var h,_=e.axis===r.AxisSpecifier.ANCESTOR||e.axis===r.AxisSpecifier.ANCESTOR_OR_SELF||e.axis===r.AxisSpecifier.PRECEDING||e.axis===r.AxisSpecifier.PRECEDING_SIBLING,y=0,v=[],E=l.iterator(_);h=E.next();){y++;var N=e.predicates.every(function(e){var t=n.evaluate(e,new i(h,y,l.length()),u);return null===t?!1:t instanceof o?t.asNumber()===y:t.asBoolean()});N&&v.push(h)}l=new a(v)}return l}}},{"../axes":27,"../context":41,"../node":94,"../types/node_set_type":96,"../types/number_type":97,"../xpath_expression":102,"xpath-analyzer":25}],65:[function(e,t){"use strict";var r=e("../xpath_expression"),n=e("../types/number_type");t.exports={evaluate:function(e,t,s){var i=r.evaluate(e.lhs,t,s),o=r.evaluate(e.rhs,t,s);return new n(i.asNumber()-o.asNumber())}}},{"../types/number_type":97,"../xpath_expression":102}],66:[function(e,t){"use strict";var r=e("../xpath_expression");t.exports={evaluate:function(e,t,n){var s=r.evaluate(e.lhs,t,n),i=r.evaluate(e.rhs,t,n);return s.merge(i)}}},{"../xpath_expression":102}],67:[function(e,t){t.exports={};var r=e("./functions/boolean"),n=e("./functions/ceiling"),s=e("./functions/concat"),i=e("./functions/contains"),o=e("./functions/count"),a=e("./functions/false"),p=e("./functions/floor"),u=e("./functions/id"),l=e("./functions/last"),c=e("./functions/local_name"),f=e("./functions/name"),x=e("./functions/normalize_space"),h=e("./functions/not"),_=e("./functions/number"),y=e("./functions/position"),v=e("./functions/round"),E=e("./functions/starts_with"),N=e("./functions/string_length"),d=e("./functions/string"),g=e("./functions/substring_after"),w=e("./functions/substring_before"),T=e("./functions/substring"),m=e("./functions/sum"),O=e("./functions/translate"),R=e("./functions/true");t.exports["boolean"]=r,t.exports.ceiling=n,t.exports.concat=s,t.exports.contains=i,t.exports.count=o,t.exports["false"]=a,t.exports.floor=p,t.exports.id=u,t.exports.last=l,t.exports["local-name"]=c,t.exports.name=f,t.exports["normalize-space"]=x,t.exports.not=h,t.exports.number=_,t.exports.position=y,t.exports.round=v,t.exports["starts-with"]=E,t.exports["string-length"]=N,t.exports.string=d,t.exports["substring-after"]=g,t.exports["substring-before"]=w,t.exports.substring=T,t.exports.sum=m,t.exports.translate=O,t.exports["true"]=R},{"./functions/boolean":68,"./functions/ceiling":69,"./functions/concat":70,"./functions/contains":71,"./functions/count":72,"./functions/false":73,"./functions/floor":74,"./functions/id":75,"./functions/last":76,"./functions/local_name":77,"./functions/name":78,"./functions/normalize_space":79,"./functions/not":80,"./functions/number":81,"./functions/position":82,"./functions/round":83,"./functions/starts_with":84,"./functions/string":85,"./functions/string_length":86,"./functions/substring":87,"./functions/substring_after":88,"./functions/substring_before":89,"./functions/sum":90,"./functions/translate":91,"./functions/true":92}],68:[function(e,t){"use strict";var r=e("../types/boolean_type");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");return new r(t.asBoolean())}}},{"../types/boolean_type":95}],69:[function(e,t){
"use strict";var r=e("../types/number_type");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");return new r(Math.ceil(t.asNumber()))}}},{"../types/number_type":97}],70:[function(e,t){"use strict";var r=e("../types/string_type");t.exports={evaluate:function(){var e=[].slice.call(arguments);if(e.shift(),0===e.length)throw new Error("Expected some arguments");return e=e.map(function(e){return e.asString()}),new r(e.join(""))}}},{"../types/string_type":98}],71:[function(e,t){"use strict";var r=e("../types/boolean_type");t.exports={evaluate:function(e,t,n){if(!n)throw new Error("Expected two arguments");return t=t.asString(),n=n.asString(),new r(-1!==t.indexOf(n))}}},{"../types/boolean_type":95}],72:[function(e,t){"use strict";var r=e("../types/node_set_type"),n=e("../types/number_type");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");return new n(t.length())}}},{"../types/node_set_type":96,"../types/number_type":97}],73:[function(e,t){"use strict";var r=e("../types/boolean_type");t.exports={evaluate:function(){return new r(!1)}}},{"../types/boolean_type":95}],74:[function(e,t){"use strict";var r=e("../types/number_type");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");return new r(Math.floor(t.asNumber()))}}},{"../types/number_type":97}],75:[function(e,t){"use strict";var r=e("../types/node_set_type"),n=e("../types/string_type");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");var s,i=[];if(t instanceof r)for(var o=t.iterator();s=o.next();)i=i.concat(s.asString().split(/\s+/g));else t instanceof n?i=t.asString().split(/\s+/g):i.push(t.asString());for(var a=new r,p=0;p<i.length;p++)s=e.getNode().getOwnerDocument().getElementById(i[p]),s&&(a=a.merge(new r([s])));return a}}},{"../types/node_set_type":96,"../types/string_type":98}],76:[function(e,t){"use strict";var r=e("../types/number_type");t.exports={evaluate:function(e){return new r(e.getLast())}}},{"../types/number_type":97}],77:[function(e,t){"use strict";var r=e("../types/node_set_type"),n=e("../types/number_type");t.exports={evaluate:function(e,t){if(t||(t=new r([e.getNode()])),arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");return new n(t.empty()?"":t.first().getName())}}},{"../types/node_set_type":96,"../types/number_type":97}],78:[function(e,t){"use strict";var r=e("../types/string_type"),n=e("../types/node_set_type");t.exports={evaluate:function(e,t){if(t){if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof n))throw new Error("Wrong type of argument");return new r(t.empty()?"":t.first().getName())}return new r(e.getNode().getName())}}},{"../types/node_set_type":96,"../types/string_type":98}],79:[function(e,t){"use strict";var r=e("../types/string_type");t.exports={evaluate:function(e,t){var n;if(t){if(arguments.length>2)throw new Error("Unknown argument(s)");n=t.asString()}else n=e.getNode().asString();return new r(n.trim().replace(/\s{2,}/g," "))}}},{"../types/string_type":98}],80:[function(e,t){"use strict";var r=e("../types/boolean_type");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");return new r(!t.asBoolean())}}},{"../types/boolean_type":95}],81:[function(e,t){"use strict";var r=e("../types/number_type");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");return new r(t.asNumber())}}},{"../types/number_type":97}],82:[function(e,t){"use strict";var r=e("../types/number_type");t.exports={evaluate:function(e){return new r(e.getPosition())}}},{"../types/number_type":97}],83:[function(e,t){"use strict";var r=e("../types/number_type");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");return new r(Math.round(t.asNumber()))}}},{"../types/number_type":97}],84:[function(e,t){"use strict";var r=e("../types/boolean_type");t.exports={evaluate:function(e,t,n){if(!n)throw new Error("Expected two arguments");t=t.asString(),n=n.asString();var s=t.indexOf(n);return new r(0===s)}}},{"../types/boolean_type":95}],85:[function(e,t){"use strict";var r=e("../types/node_set_type"),n=e("../types/string_type");t.exports={evaluate:function(e,t){if(t||(t=new r([e.getNode()])),arguments.length>2)throw new Error("Unknown argument(s)");return new n(t.asString())}}},{"../types/node_set_type":96,"../types/string_type":98}],86:[function(e,t){"use strict";var r=e("../types/string_type"),n=e("../types/number_type");t.exports={evaluate:function(e,t){if(t){if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");t=t.asString()}else t=e.getNode().asString();return new n(t.length)}}},{"../types/number_type":97,"../types/string_type":98}],87:[function(e,t){"use strict";var r=e("../types/string_type");t.exports={evaluate:function(e,t,n,s){if(!n)throw new Error("Expected two or three arguments");return t=t.asString(),n=Math.round(n.asNumber()),new r(isNaN(n)||n===1/0||n===-(1/0)?"":s&&(s=Math.round(s.asNumber()),isNaN(s)||s===-(1/0))?"":s?t.substring(n-1,n+s-1):t.substring(n-1))}}},{"../types/string_type":98}],88:[function(e,t){"use strict";var r=e("../types/string_type");t.exports={evaluate:function(e,t,n){if(!n)throw new Error("Expected two arguments");t=t.asString(),n=n.asString();var s=t.indexOf(n);return new r(-1===s?"":t.substring(s+n.length))}}},{"../types/string_type":98}],89:[function(e,t){"use strict";var r=e("../types/string_type");t.exports={evaluate:function(e,t,n){if(!n)throw new Error("Expected two arguments");t=t.asString(),n=n.asString();var s=t.indexOf(n);return new r(-1===s?"":t.substring(0,s))}}},{"../types/string_type":98}],90:[function(e,t){"use strict";var r=e("../types/node_set_type"),n=e("../types/number_type");t.exports={evaluate:function(e,t){if(!t)throw new Error("Missing argument");if(arguments.length>2)throw new Error("Unknown argument(s)");if(!(t instanceof r))throw new Error("Wrong type of argument");for(var s,i=0,o=t.iterator();s=o.next();)i+=s.asNumber();return new n(i)}}},{"../types/node_set_type":96,"../types/number_type":97}],91:[function(e,t){"use strict";var r=e("../types/string_type");t.exports={evaluate:function(e,t,n,s){if(!s)throw new Error("Expected three arguments");if(!(t instanceof r&&n instanceof r&&s instanceof r))throw new Error("Expected string arguments");t=t.asString(),n=n.asString(),s=s.asString();for(var i=0;i<n.length;i++)t=i<s.length?t.replace(new RegExp(n[i],"g"),s[i]):t.replace(new RegExp(n[i],"g"),"");return new r(t)}}},{"../types/string_type":98}],92:[function(e,t){"use strict";var r=e("../types/boolean_type");t.exports={evaluate:function(){return new r(!0)}}},{"../types/boolean_type":95}],93:[function(e,t){"use strict";function r(e,t){this.list=e,this.reversed=t,this.current=t?e.last():e.first(),this.lastReturned=null,this.i=0}r.prototype.next=function(){if(this.i++,this.i>1e4)throw new Error("An error has probably ocurred!");return this.current?(this.lastReturned=this.current,this.current=this.reversed?this.current.previous:this.current.next,this.lastReturned):void 0},r.prototype.remove=function(){if(!this.lastReturned)throw new Error("remove was called before iterating!");var e=this.lastReturned.next,t=this.lastReturned.previous;e?e.previous=t:this.list.last_=t,t?t.next=e:this.list.first_=e,this.lastReturned=null,this.list.length_--},t.exports=r},{}],94:[function(e,t){t.exports={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}},{}],95:[function(e,t){"use strict";function r(e){this.value=e}r.prototype.asString=function(){return""+this.value},r.prototype.asNumber=function(){return this.value?1:0},r.prototype.asBoolean=function(){return this.value},t.exports=r},{}],96:[function(e,t){"use strict";function r(e){this.first_=null,this.last_=null,this.length_=0,e&&e.forEach(function(e){this.push(e)},this)}var n=e("../adapter"),s=e("../iterator");r.prototype.iterator=function(e){return new s(this,e)},r.prototype.first=function(){return this.first_},r.prototype.last=function(){return this.last_},r.prototype.length=function(){return this.length_},r.prototype.empty=function(){return 0===this.length()},r.prototype.asString=function(){return this.empty()?"":this.first().asString()},r.prototype.asNumber=function(){return+this.asString()},r.prototype.asBoolean=function(){return 0!==this.length()},r.prototype.merge=function(e){return r.merge(this,e)},r.prototype.push=function(e){return e.next=null,e.previous=this.last_,this.first_?this.last_.next=e:this.first_=e,this.last_=e,this.length_++,this},r.prototype.unshift=function(e){return e.previous=null,e.next=this.first_,this.first_?this.first_.previous=e:this.last_=e,this.first_=e,this.length_++,this},r.prototype.filter=function(e){for(var t,r=this.iterator();t=r.next();)e(t)||r.remove();return this},r.merge=function(e,t){var s=n.getAdapter().compareDocumentPosition;return s?r.mergeWithOrder(e,t,s):r.mergeWithoutOrder(e,t)},r.mergeWithOrder=function(e,t,r){if(!e.first_)return t;if(!t.first_)return e;for(var n=e.first_,s=t.first_,i=e,o=null,a=null,p=0;n&&s;){if(n.getNativeNode()===s.getNativeNode())a=n,n=n.next,s=s.next;else{var u=r(n,s);u>0?(a=s,s=s.next):(a=n,n=n.next)}a.previous=o,o?o.next=a:i.first_=a,o=a,p++}for(a=n||s;a;)a.previous=o,o.next=a,o=a,p++,a=a.next;return i.last_=o,i.length_=p,i},r.mergeWithoutOrder=function(e,t){for(var n,s=[],i=e.iterator();n=i.next();)s.push(n);for(i=t.iterator();n=i.next();){var o=s.every(function(e){return e.getNativeNode()!==n.getNativeNode()});o&&s.push(n)}return new r(s)},r.prototype.toString=function(){for(var e,t=this.iterator(),r=[];e=t.next();)r.push(""+e);return"NodeSet<"+r.join(", ")+">"},t.exports=r},{"../adapter":26,"../iterator":93}],97:[function(e,t){"use strict";function r(e){this.value=e}r.prototype.asString=function(){return""+this.value},r.prototype.asNumber=function(){return this.value},r.prototype.asBoolean=function(){return!!this.value},t.exports=r},{}],98:[function(e,t){"use strict";function r(e){this.value=e}r.prototype.asString=function(){return this.value},r.prototype.asNumber=function(){return+this.value},r.prototype.asBoolean=function(){return 0!==this.value.length},t.exports=r},{}],99:[function(e,t){"use strict";function r(){throw new Error("Namespaces are not implemented")}var n=e("./xpath_expression"),s=e("./xpath_result"),i=e("./adapter"),o=e("./node");t.exports={evaluate:function(e,t,n,o){n&&r();var a=this.createExpression(e).evaluate(t,o,i.getAdapter());return new s(o,a)},createExpression:function(e,t){return t&&r(),new n(e)},createNSResolver:function(){r()},setAdapter:function(e){i.setAdapter(e)},XPathResult:s,Node:o}},{"./adapter":26,"./node":94,"./xpath_expression":102,"./xpath_result":103}],100:[function(e,t){"use strict";function r(e,t){this.code=e,this.message=t}t.exports=r},{}],101:[function(e,t){t.exports={INVALID_EXPRESSION_ERR:51,TYPE_ERR:52}},{}],102:[function(e,t){"use strict";function r(e){this.expression=e}t.exports=r;var n=e("xpath-analyzer"),s=e("./context"),i=e("./evaluators");r.evaluate=function(e,t,r){var n=i[e.type];return n.evaluate(e,t,r)},r.prototype.evaluate=function(e,t,i){var o=new n(this.expression).parse();return r.evaluate(o,new s(new i(e)),t)}},{"./context":41,"./evaluators":42,"xpath-analyzer":25}],103:[function(e,t){"use strict";function r(e,t){if(this.value=t,e===i.ANY_TYPE)if(t instanceof o)this.resultType=i.UNORDERED_NODE_ITERATOR_TYPE;else if(t instanceof a)this.resultType=i.STRING_TYPE;else if(t instanceof p)this.resultType=i.NUMBER_TYPE;else{if(!(t instanceof u))throw new Error("Unexpected evaluation result");this.resultType=i.BOOLEAN_TYPE}else this.resultType=e;if(this.resultType!==i.STRING_TYPE&&this.resultType!==i.NUMBER_TYPE&&this.resultType!==i.BOOLEAN_TYPE&&!(t instanceof o))throw Error("Value could not be converted to the specified type");if(this.resultType===i.UNORDERED_NODE_ITERATOR_TYPE||this.resultType===i.ORDERED_NODE_ITERATOR_TYPE||this.resultType===i.UNORDERED_NODE_SNAPSHOT_TYPE||this.resultType===i.ORDERED_NODE_SNAPSHOT_TYPE){this.nodes=[];for(var r,l=this.value.iterator();r=l.next();)this.nodes.push(r.getNativeNode())}var c=this,f=!0;try{Object.defineProperty({},"x",{})}catch(x){f=!1}f?(Object.defineProperty(this,"numberValue",{get:function(){if(c.resultType!==i.NUMBER_TYPE)throw new n(s.TYPE_ERR,"resultType is not NUMBER_TYPE");return c.value.asNumber()}}),Object.defineProperty(this,"stringValue",{get:function(){if(c.resultType!==i.STRING_TYPE)throw new n(s.TYPE_ERR,"resultType is not STRING_TYPE");return c.value.asString()}}),Object.defineProperty(this,"booleanValue",{get:function(){if(c.resultType!==i.BOOLEAN_TYPE)throw new n(s.TYPE_ERR,"resultType is not BOOLEAN_TYPE");return c.value.asBoolean()}}),Object.defineProperty(this,"singleNodeValue",{get:function(){if(c.resultType!==i.FIRST_ORDERED_NODE_TYPE&&c.resultType!==i.ANY_UNORDERED_NODE_TYPE)throw new n(s.TYPE_ERR,"resultType is not a node set");return c.value.empty()?null:c.value.first().getNativeNode()}}),Object.defineProperty(this,"invalidIteratorState",{get:function(){throw new Error("invalidIteratorState is not implemented")}}),Object.defineProperty(this,"snapshotLength",{get:function(){if(c.resultType!==i.ORDERED_NODE_SNAPSHOT_TYPE&&c.resultType!==i.UNORDERED_NODE_SNAPSHOT_TYPE)throw new n(s.TYPE_ERR,"resultType is not a node set");return c.value.length()}})):(c.resultType===i.NUMBER_TYPE&&(c.numberValue=c.value.asNumber()),c.resultType===i.STRING_TYPE&&(c.stringValue=c.value.asString()),c.resultType===i.BOOLEAN_TYPE&&(c.booleanValue=c.value.asBoolean()),(c.resultType===i.FIRST_ORDERED_NODE_TYPE||c.resultType===i.ANY_UNORDERED_NODE_TYPE)&&(c.singleNodeValue=c.value.empty()?null:c.value.first().getNativeNode()),(c.resultType===i.ORDERED_NODE_SNAPSHOT_TYPE||c.resultType===i.UNORDERED_NODE_SNAPSHOT_TYPE)&&(c.snapshotLength=c.value.length()))}var n=e("./xpath_exception"),s=e("./xpath_exception_code"),i=e("./xpath_result_type"),o=e("./types/node_set_type"),a=e("./types/string_type"),p=e("./types/number_type"),u=e("./types/boolean_type");r.prototype.iterateNext=function(){if(this.resultType!==i.ORDERED_NODE_ITERATOR_TYPE&&this.resultType!==i.UNORDERED_NODE_ITERATOR_TYPE)throw new n(s.TYPE_ERR,"iterateNext called with wrong result type");return this.index=this.index||0,this.index.length>=this.nodes.length?null:this.nodes[this.index]},r.prototype.snapshotItem=function(e){if(this.resultType!==i.ORDERED_NODE_SNAPSHOT_TYPE&&this.resultType!==i.UNORDERED_NODE_SNAPSHOT_TYPE)throw new n(s.TYPE_ERR,"snapshotItem called with wrong result type");return this.nodes[e]||null};for(var l in i)i.hasOwnProperty(l)&&(r[l]=i[l]);t.exports=r},{"./types/boolean_type":95,"./types/node_set_type":96,"./types/number_type":97,"./types/string_type":98,"./xpath_exception":100,"./xpath_exception_code":101,"./xpath_result_type":104}],104:[function(e,t){t.exports={ANY_TYPE:0,NUMBER_TYPE:1,STRING_TYPE:2,BOOLEAN_TYPE:3,UNORDERED_NODE_ITERATOR_TYPE:4,ORDERED_NODE_ITERATOR_TYPE:5,UNORDERED_NODE_SNAPSHOT_TYPE:6,ORDERED_NODE_SNAPSHOT_TYPE:7,ANY_UNORDERED_NODE_TYPE:8,FIRST_ORDERED_NODE_TYPE:9}},{}],105:[function(e,t){"use strict";function r(e){this.tokens=r.tokenize(e),this.index=0}r.prototype.next=function(){return this.tokens[this.index++]},r.prototype.back=function(){this.index--},r.prototype.peak=function(e){return this.tokens[this.index+(e||0)]},r.prototype.empty=function(){return this.tokens.length<=this.index},r.tokenize=function(e){var t=e.match(new RegExp(["\\$?(?:(?![0-9-])[\\w-]+:)?(?![0-9-])[\\w-]+","\\d+\\.\\d+","\\.\\d+","\\d+","\\/\\/","/","\\.\\.","\\.","\\s+","::",",","@","-","=","!=","<=","<",">=",">","\\|","\\+","\\*","\\(","\\)","\\[","\\]",'"[^"]*"',"'[^']*'"].join("|"),"g"));if(!t||t.join("")!==e)throw new Error("Invalid XPath expression");return t.filter(function(e){return!/^\s+$/.test(e)})},t.exports=r},{}],106:[function(e,t){var r=e("xpath-evaluator"),n=e("./lib/xpath_dom");r.setAdapter(n),t.exports=r},{"./lib/xpath_dom":2,"xpath-evaluator":99}]},{},[1])(1)});